2020-11-29 19:33:15.845990: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-11-29 19:33:15.870252: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3000000000 Hz
2020-11-29 19:33:15.872322: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564997cac7f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-29 19:33:15.872370: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version

Loading data for Movie Lens: Users, Movies, Ratings

Users: [3808 1388 4509 ... 2898 3024  827] , shape = (1000209,)
Movies: [2923 1956 1478 ... 2663 1295 1380] , shape = (1000209,)
Ratings: [4 4 2 ... 4 5 2] , shape = (1000209,)

build_model: concatenate, dense layers: [64, 32, 1]

Model Summary

Model Parameters:
	merge layer: concatenate
	embedding size: 50
	dense layers: [64, 32, 1]

Save name: concatenate_50_64_32_1.h5
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 1)]          0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            [(None, 1)]          0                                            
__________________________________________________________________________________________________
embedding (Embedding)           (None, 1, 50)        302000      input_1[0][0]                    
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 1, 50)        197600      input_2[0][0]                    
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 1, 100)       0           embedding[0][0]                  
                                                                 embedding_1[0][0]                
__________________________________________________________________________________________________
dense (Dense)                   (None, 1, 64)        6464        concatenate[0][0]                
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1, 32)        2080        dense[0][0]                      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1, 1)         33          dense_1[0][0]                    
==================================================================================================
Total params: 508,177
Trainable params: 508,177
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/30
28131/28131 - 66s - loss: 0.9191 - val_loss: 0.8585
Epoch 2/30
28131/28131 - 65s - loss: 0.8354 - val_loss: 0.8408
Epoch 3/30
28131/28131 - 66s - loss: 0.8290 - val_loss: 0.8320
Epoch 4/30
28131/28131 - 66s - loss: 0.8262 - val_loss: 0.8318
Epoch 5/30
28131/28131 - 66s - loss: 0.8243 - val_loss: 0.8322
Epoch 6/30
28131/28131 - 67s - loss: 0.8230 - val_loss: 0.8303
Epoch 7/30
28131/28131 - 66s - loss: 0.8221 - val_loss: 0.8300
Epoch 8/30
28131/28131 - 66s - loss: 0.8213 - val_loss: 0.8304
Epoch 9/30
28131/28131 - 66s - loss: 0.8207 - val_loss: 0.8296
Epoch 10/30
28131/28131 - 66s - loss: 0.8200 - val_loss: 0.8289
Epoch 11/30
28131/28131 - 66s - loss: 0.8193 - val_loss: 0.8282
Epoch 12/30
28131/28131 - 66s - loss: 0.8188 - val_loss: 0.8269
Epoch 13/30
28131/28131 - 66s - loss: 0.8186 - val_loss: 0.8280
Epoch 14/30
28131/28131 - 66s - loss: 0.8181 - val_loss: 0.8266
Epoch 15/30
28131/28131 - 66s - loss: 0.8178 - val_loss: 0.8268
Epoch 16/30
28131/28131 - 66s - loss: 0.8174 - val_loss: 0.8265
Epoch 17/30
28131/28131 - 66s - loss: 0.8172 - val_loss: 0.8256
Epoch 18/30
28131/28131 - 65s - loss: 0.8168 - val_loss: 0.8269
Epoch 19/30
28131/28131 - 66s - loss: 0.8166 - val_loss: 0.8269
Minimum RMSE at epoch 17 = 0.9086

Model Evaluation

build_model: concatenate, dense layers: [64, 32, 1]

Display Predicted User Ratings and Actual Ratings

    user_id  movie_id  rating   prediction                                   title                        genres
0      2000      1639       5  [3.7936523]                      Chasing Amy (1997)                 Drama|Romance
1      2000      2529       5  [3.7708504]               Planet of the Apes (1968)                 Action|Sci-Fi
2      2000      1136       5  [4.2957325]  Monty Python and the Holy Grail (1974)                        Comedy
3      2000      2321       5  [3.6180155]                    Pleasantville (1998)                        Comedy
4      2000      2858       5    [4.21943]                  American Beauty (1999)                  Comedy|Drama
5      2000      2501       5   [4.132479]                      October Sky (1999)                         Drama
6      2000      2804       5   [4.177065]               Christmas Story, A (1983)                  Comedy|Drama
7      2000      1688       5   [3.405814]                        Anastasia (1997)  Animation|Children's|Musical
8      2000      1653       5   [3.598845]                          Gattaca (1997)         Drama|Sci-Fi|Thriller
9      2000       527       5  [4.4883885]                 Schindler's List (1993)                     Drama|War
10     2000      1619       5  [3.4250188]             Seven Years in Tibet (1997)                     Drama|War
11     2000       110       5   [4.135748]                       Braveheart (1995)              Action|Drama|War
12     2000      1193       5  [4.3578086]  One Flew Over the Cuckoo's Nest (1975)                         Drama
13     2000       318       5  [4.5500154]        Shawshank Redemption, The (1994)                         Drama
14     2000      1748       5  [3.7649367]                        Dark City (1998)     Film-Noir|Sci-Fi|Thriller
15     2000      1923       5  [3.8812847]     There's Something About Mary (1998)                        Comedy
16     2000      1259       5  [4.0258975]                      Stand by Me (1986)        Adventure|Comedy|Drama
17     2000       595       5  [3.7938976]             Beauty and the Beast (1991)  Animation|Children's|Musical
18     2000      2028       5  [4.3008633]              Saving Private Ryan (1998)              Action|Drama|War
19     2000      1907       5   [3.674811]                            Mulan (1998)          Animation|Children's

Display Predicted User Ratings for Recommendation

    movie_id   prediction                                              title                     genres
0       2905  [4.6062293]                                     Sanjuro (1962)           Action|Adventure
1        922  [4.5146346]      Sunset Blvd. (a.k.a. Sunset Boulevard) (1950)                  Film-Noir
2       2019  [4.5111957]  Seven Samurai (The Magnificent Seven) (Shichin...               Action|Drama
3       1148  [4.5105824]                         Wrong Trousers, The (1993)           Animation|Comedy
4       1212  [4.4936028]                              Third Man, The (1949)           Mystery|Thriller
5        904   [4.481784]                                 Rear Window (1954)           Mystery|Thriller
6       1178  [4.4540834]                              Paths of Glory (1957)                  Drama|War
7        750   [4.431326]  Dr. Strangelove or: How I Learned to Stop Worr...                 Sci-Fi|War
8       3435   [4.430449]                            Double Indemnity (1944)            Crime|Film-Noir
9       3089   [4.426761]    Bicycle Thief, The (Ladri di biciclette) (1948)                      Drama
10      3030  [4.4174113]                                     Yojimbo (1961)       Comedy|Drama|Western
11       858   [4.410775]                              Godfather, The (1972)         Action|Crime|Drama
12       908   [4.404552]                          North by Northwest (1959)             Drama|Thriller
13       923   [4.394918]                                Citizen Kane (1941)                      Drama
14       745   [4.388971]                              Close Shave, A (1995)  Animation|Comedy|Thriller
15      1250  [4.3876395]               Bridge on the River Kwai, The (1957)                  Drama|War
16      1207  [4.3872175]                       To Kill a Mockingbird (1962)                      Drama
17      3022  [4.3764334]                                General, The (1927)                     Comedy
18       953   [4.368992]                       It's a Wonderful Life (1946)                      Drama
19       913   [4.368081]                         Maltese Falcon, The (1941)          Film-Noir|Mystery
build_model: concatenate, dense layers: [32, 16, 1]

Model Summary

Model Parameters:
	merge layer: concatenate
	embedding size: 50
	dense layers: [32, 16, 1]

Save name: concatenate_50_32_16_1.h5
Model: "functional_5"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_5 (InputLayer)            [(None, 1)]          0                                            
__________________________________________________________________________________________________
input_6 (InputLayer)            [(None, 1)]          0                                            
__________________________________________________________________________________________________
embedding_4 (Embedding)         (None, 1, 50)        302000      input_5[0][0]                    
__________________________________________________________________________________________________
embedding_5 (Embedding)         (None, 1, 50)        197600      input_6[0][0]                    
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 1, 100)       0           embedding_4[0][0]                
                                                                 embedding_5[0][0]                
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 1, 32)        3232        concatenate_2[0][0]              
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 1, 16)        528         dense_6[0][0]                    
__________________________________________________________________________________________________
dense_8 (Dense)                 (None, 1, 1)         17          dense_7[0][0]                    
==================================================================================================
Total params: 503,377
Trainable params: 503,377
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/30
28131/28131 - 64s - loss: 0.9255 - val_loss: 0.8413
Epoch 2/30
28131/28131 - 64s - loss: 0.8343 - val_loss: 0.8330
Epoch 3/30
28131/28131 - 64s - loss: 0.8284 - val_loss: 0.8328
Epoch 4/30
28131/28131 - 64s - loss: 0.8257 - val_loss: 0.8339
Epoch 5/30
28131/28131 - 64s - loss: 0.8240 - val_loss: 0.8295
Epoch 6/30
28131/28131 - 64s - loss: 0.8226 - val_loss: 0.8280
Epoch 7/30
28131/28131 - 64s - loss: 0.8217 - val_loss: 0.8310
Epoch 8/30
28131/28131 - 64s - loss: 0.8208 - val_loss: 0.8289
Minimum RMSE at epoch 6 = 0.9100

Model Evaluation

build_model: concatenate, dense layers: [32, 16, 1]

Display Predicted User Ratings and Actual Ratings

    user_id  movie_id  rating   prediction                                   title                        genres
0      2000      1639       5  [3.7480254]                      Chasing Amy (1997)                 Drama|Romance
1      2000      2529       5  [3.6298995]               Planet of the Apes (1968)                 Action|Sci-Fi
2      2000      1136       5  [4.3450484]  Monty Python and the Holy Grail (1974)                        Comedy
3      2000      2321       5  [3.7875261]                    Pleasantville (1998)                        Comedy
4      2000      2858       5  [4.2974167]                  American Beauty (1999)                  Comedy|Drama
5      2000      2501       5  [4.0983644]                      October Sky (1999)                         Drama
6      2000      2804       5   [4.205449]               Christmas Story, A (1983)                  Comedy|Drama
7      2000      1688       5  [3.4472775]                        Anastasia (1997)  Animation|Children's|Musical
8      2000      1653       5  [3.8465478]                          Gattaca (1997)         Drama|Sci-Fi|Thriller
9      2000       527       5   [4.529526]                 Schindler's List (1993)                     Drama|War
10     2000      1619       5  [3.5000057]             Seven Years in Tibet (1997)                     Drama|War
11     2000       110       5  [4.1980834]                       Braveheart (1995)              Action|Drama|War
12     2000      1193       5  [4.4161487]  One Flew Over the Cuckoo's Nest (1975)                         Drama
13     2000       318       5   [4.538275]        Shawshank Redemption, The (1994)                         Drama
14     2000      1748       5   [3.889668]                        Dark City (1998)     Film-Noir|Sci-Fi|Thriller
15     2000      1923       5  [3.8694217]     There's Something About Mary (1998)                        Comedy
16     2000      1259       5   [4.020636]                      Stand by Me (1986)        Adventure|Comedy|Drama
17     2000       595       5  [3.9143527]             Beauty and the Beast (1991)  Animation|Children's|Musical
18     2000      2028       5   [4.328995]              Saving Private Ryan (1998)              Action|Drama|War
19     2000      1907       5  [3.6076765]                            Mulan (1998)          Animation|Children's

Display Predicted User Ratings for Recommendation

    movie_id   prediction                                              title                              genres
0       2905  [4.5844073]                                     Sanjuro (1962)                    Action|Adventure
1        922  [4.5470176]      Sunset Blvd. (a.k.a. Sunset Boulevard) (1950)                           Film-Noir
2       1207   [4.525113]                       To Kill a Mockingbird (1962)                               Drama
3        858   [4.522781]                              Godfather, The (1972)                  Action|Crime|Drama
4       3030  [4.5214763]                                     Yojimbo (1961)                Comedy|Drama|Western
5       1178   [4.498836]                              Paths of Glory (1957)                           Drama|War
6        745   [4.496478]                              Close Shave, A (1995)           Animation|Comedy|Thriller
7       1212   [4.495376]                              Third Man, The (1949)                    Mystery|Thriller
8       1204  [4.4910493]                          Lawrence of Arabia (1962)                       Adventure|War
9       3089  [4.4909873]    Bicycle Thief, The (Ladri di biciclette) (1948)                               Drama
10      2019    [4.48657]  Seven Samurai (The Magnificent Seven) (Shichin...                        Action|Drama
11      1252  [4.4779263]                                   Chinatown (1974)          Film-Noir|Mystery|Thriller
12       296   [4.472166]                                Pulp Fiction (1994)                         Crime|Drama
13       919   [4.460619]                           Wizard of Oz, The (1939)  Adventure|Children's|Drama|Musical
14      1148   [4.453827]                         Wrong Trousers, The (1993)                    Animation|Comedy
15       904  [4.4271946]                                 Rear Window (1954)                    Mystery|Thriller
16       720   [4.423287]  Wallace & Gromit: The Best of Aardman Animatio...                           Animation
17       750  [4.4105773]  Dr. Strangelove or: How I Learned to Stop Worr...                          Sci-Fi|War
18      3022  [4.3986406]                                General, The (1927)                              Comedy
19       903   [4.395938]                                     Vertigo (1958)                    Mystery|Thriller
build_model: concatenate, dense layers: [64, 32, 1]

Model Summary

Model Parameters:
	merge layer: concatenate
	embedding size: 100
	dense layers: [64, 32, 1]

Save name: concatenate_100_64_32_1.h5
Model: "functional_9"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_9 (InputLayer)            [(None, 1)]          0                                            
__________________________________________________________________________________________________
input_10 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
embedding_8 (Embedding)         (None, 1, 100)       604000      input_9[0][0]                    
__________________________________________________________________________________________________
embedding_9 (Embedding)         (None, 1, 100)       395200      input_10[0][0]                   
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 1, 200)       0           embedding_8[0][0]                
                                                                 embedding_9[0][0]                
__________________________________________________________________________________________________
dense_12 (Dense)                (None, 1, 64)        12864       concatenate_4[0][0]              
__________________________________________________________________________________________________
dense_13 (Dense)                (None, 1, 32)        2080        dense_12[0][0]                   
__________________________________________________________________________________________________
dense_14 (Dense)                (None, 1, 1)         33          dense_13[0][0]                   
==================================================================================================
Total params: 1,014,177
Trainable params: 1,014,177
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/30
28131/28131 - 70s - loss: 0.9139 - val_loss: 0.8438
Epoch 2/30
28131/28131 - 71s - loss: 0.8364 - val_loss: 0.8386
Epoch 3/30
28131/28131 - 71s - loss: 0.8299 - val_loss: 0.8354
Epoch 4/30
28131/28131 - 72s - loss: 0.8271 - val_loss: 0.8321
Epoch 5/30
28131/28131 - 72s - loss: 0.8253 - val_loss: 0.8307
Epoch 6/30
28131/28131 - 71s - loss: 0.8239 - val_loss: 0.8322
Epoch 7/30
28131/28131 - 72s - loss: 0.8228 - val_loss: 0.8281
Epoch 8/30
28131/28131 - 71s - loss: 0.8217 - val_loss: 0.8303
Epoch 9/30
28131/28131 - 72s - loss: 0.8212 - val_loss: 0.8280
Epoch 10/30
28131/28131 - 71s - loss: 0.8203 - val_loss: 0.8271
Epoch 11/30
28131/28131 - 73s - loss: 0.8199 - val_loss: 0.8283
Epoch 12/30
28131/28131 - 71s - loss: 0.8195 - val_loss: 0.8272
Minimum RMSE at epoch 10 = 0.9094

Model Evaluation

build_model: concatenate, dense layers: [64, 32, 1]

Display Predicted User Ratings and Actual Ratings

    user_id  movie_id  rating   prediction                                   title                        genres
0      2000      1639       5  [3.6913233]                      Chasing Amy (1997)                 Drama|Romance
1      2000      2529       5  [3.6960816]               Planet of the Apes (1968)                 Action|Sci-Fi
2      2000      1136       5   [4.325762]  Monty Python and the Holy Grail (1974)                        Comedy
3      2000      2321       5   [3.603806]                    Pleasantville (1998)                        Comedy
4      2000      2858       5  [4.2220864]                  American Beauty (1999)                  Comedy|Drama
5      2000      2501       5   [4.195411]                      October Sky (1999)                         Drama
6      2000      2804       5  [4.1249433]               Christmas Story, A (1983)                  Comedy|Drama
7      2000      1688       5   [3.429817]                        Anastasia (1997)  Animation|Children's|Musical
8      2000      1653       5  [3.6418302]                          Gattaca (1997)         Drama|Sci-Fi|Thriller
9      2000       527       5  [4.4745774]                 Schindler's List (1993)                     Drama|War
10     2000      1619       5  [3.4497147]             Seven Years in Tibet (1997)                     Drama|War
11     2000       110       5  [4.2280726]                       Braveheart (1995)              Action|Drama|War
12     2000      1193       5  [4.3332076]  One Flew Over the Cuckoo's Nest (1975)                         Drama
13     2000       318       5   [4.550562]        Shawshank Redemption, The (1994)                         Drama
14     2000      1748       5   [3.787489]                        Dark City (1998)     Film-Noir|Sci-Fi|Thriller
15     2000      1923       5  [3.9345107]     There's Something About Mary (1998)                        Comedy
16     2000      1259       5    [4.00458]                      Stand by Me (1986)        Adventure|Comedy|Drama
17     2000       595       5  [3.7713444]             Beauty and the Beast (1991)  Animation|Children's|Musical
18     2000      2028       5  [4.2220454]              Saving Private Ryan (1998)              Action|Drama|War
19     2000      1907       5  [3.7635665]                            Mulan (1998)          Animation|Children's

Display Predicted User Ratings for Recommendation

    movie_id   prediction                                              title                      genres
0       2905   [4.602452]                                     Sanjuro (1962)            Action|Adventure
1        745  [4.5889025]                              Close Shave, A (1995)   Animation|Comedy|Thriller
2       1212  [4.5165825]                              Third Man, The (1949)            Mystery|Thriller
3       1178   [4.509007]                              Paths of Glory (1957)                   Drama|War
4       1148      [4.506]                         Wrong Trousers, The (1993)            Animation|Comedy
5        922   [4.504917]      Sunset Blvd. (a.k.a. Sunset Boulevard) (1950)                   Film-Noir
6        913  [4.5046363]                         Maltese Falcon, The (1941)           Film-Noir|Mystery
7       2019  [4.4988036]  Seven Samurai (The Magnificent Seven) (Shichin...                Action|Drama
8        720   [4.473561]  Wallace & Gromit: The Best of Aardman Animatio...                   Animation
9        904    [4.47206]                                 Rear Window (1954)            Mystery|Thriller
10      3089  [4.4606423]    Bicycle Thief, The (Ladri di biciclette) (1948)                       Drama
11       858   [4.459563]                              Godfather, The (1972)          Action|Crime|Drama
12      1204    [4.45904]                          Lawrence of Arabia (1962)               Adventure|War
13       908   [4.433011]                          North by Northwest (1959)              Drama|Thriller
14      3435  [4.4263763]                            Double Indemnity (1944)             Crime|Film-Noir
15       923   [4.425187]                                Citizen Kane (1941)                       Drama
16      3022    [4.42341]                                General, The (1927)                      Comedy
17      1262  [4.4092417]                           Great Escape, The (1963)               Adventure|War
18       930   [4.400335]                                   Notorious (1946)  Film-Noir|Romance|Thriller
19      1250   [4.393387]               Bridge on the River Kwai, The (1957)                   Drama|War
build_model: concatenate, dense layers: [32, 16, 1]

Model Summary

Model Parameters:
	merge layer: concatenate
	embedding size: 100
	dense layers: [32, 16, 1]

Save name: concatenate_100_32_16_1.h5
Model: "functional_13"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_13 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
input_14 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
embedding_12 (Embedding)        (None, 1, 100)       604000      input_13[0][0]                   
__________________________________________________________________________________________________
embedding_13 (Embedding)        (None, 1, 100)       395200      input_14[0][0]                   
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 1, 200)       0           embedding_12[0][0]               
                                                                 embedding_13[0][0]               
__________________________________________________________________________________________________
dense_18 (Dense)                (None, 1, 32)        6432        concatenate_6[0][0]              
__________________________________________________________________________________________________
dense_19 (Dense)                (None, 1, 16)        528         dense_18[0][0]                   
__________________________________________________________________________________________________
dense_20 (Dense)                (None, 1, 1)         17          dense_19[0][0]                   
==================================================================================================
Total params: 1,006,177
Trainable params: 1,006,177
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/30
28131/28131 - 67s - loss: 0.9202 - val_loss: 0.8428
Epoch 2/30
28131/28131 - 69s - loss: 0.8353 - val_loss: 0.8354
Epoch 3/30
28131/28131 - 68s - loss: 0.8292 - val_loss: 0.8364
Epoch 4/30
28131/28131 - 68s - loss: 0.8265 - val_loss: 0.8330
Epoch 5/30
28131/28131 - 68s - loss: 0.8248 - val_loss: 0.8300
Epoch 6/30
28131/28131 - 69s - loss: 0.8234 - val_loss: 0.8341
Epoch 7/30
28131/28131 - 69s - loss: 0.8224 - val_loss: 0.8300
Epoch 8/30
28131/28131 - 69s - loss: 0.8217 - val_loss: 0.8289
Epoch 9/30
28131/28131 - 68s - loss: 0.8209 - val_loss: 0.8287
Epoch 10/30
28131/28131 - 69s - loss: 0.8203 - val_loss: 0.8277
Epoch 11/30
28131/28131 - 68s - loss: 0.8196 - val_loss: 0.8286
Epoch 12/30
28131/28131 - 68s - loss: 0.8191 - val_loss: 0.8271
Epoch 13/30
28131/28131 - 69s - loss: 0.8188 - val_loss: 0.8277
Epoch 14/30
28131/28131 - 69s - loss: 0.8185 - val_loss: 0.8263
Epoch 15/30
28131/28131 - 68s - loss: 0.8180 - val_loss: 0.8263
Epoch 16/30
28131/28131 - 69s - loss: 0.8175 - val_loss: 0.8267
Minimum RMSE at epoch 14 = 0.9090

Model Evaluation

build_model: concatenate, dense layers: [32, 16, 1]

Display Predicted User Ratings and Actual Ratings

    user_id  movie_id  rating   prediction                                   title                        genres
0      2000      1639       5  [3.8132107]                      Chasing Amy (1997)                 Drama|Romance
1      2000      2529       5  [3.6289756]               Planet of the Apes (1968)                 Action|Sci-Fi
2      2000      1136       5  [4.3021097]  Monty Python and the Holy Grail (1974)                        Comedy
3      2000      2321       5   [3.762334]                    Pleasantville (1998)                        Comedy
4      2000      2858       5    [4.28078]                  American Beauty (1999)                  Comedy|Drama
5      2000      2501       5   [4.116094]                      October Sky (1999)                         Drama
6      2000      2804       5  [4.2721386]               Christmas Story, A (1983)                  Comedy|Drama
7      2000      1688       5  [3.3987505]                        Anastasia (1997)  Animation|Children's|Musical
8      2000      1653       5   [3.699262]                          Gattaca (1997)         Drama|Sci-Fi|Thriller
9      2000       527       5  [4.4565744]                 Schindler's List (1993)                     Drama|War
10     2000      1619       5   [3.435653]             Seven Years in Tibet (1997)                     Drama|War
11     2000       110       5   [4.148607]                       Braveheart (1995)              Action|Drama|War
12     2000      1193       5  [4.3078723]  One Flew Over the Cuckoo's Nest (1975)                         Drama
13     2000       318       5   [4.507093]        Shawshank Redemption, The (1994)                         Drama
14     2000      1748       5  [3.8828633]                        Dark City (1998)     Film-Noir|Sci-Fi|Thriller
15     2000      1923       5   [3.940791]     There's Something About Mary (1998)                        Comedy
16     2000      1259       5  [4.1419554]                      Stand by Me (1986)        Adventure|Comedy|Drama
17     2000       595       5  [3.8830867]             Beauty and the Beast (1991)  Animation|Children's|Musical
18     2000      2028       5    [4.23967]              Saving Private Ryan (1998)              Action|Drama|War
19     2000      1907       5  [3.6991658]                            Mulan (1998)          Animation|Children's

Display Predicted User Ratings for Recommendation

    movie_id   prediction                                              title                      genres
0       2905  [4.5782404]                                     Sanjuro (1962)            Action|Adventure
1        858  [4.5194387]                              Godfather, The (1972)          Action|Crime|Drama
2       2019   [4.490502]  Seven Samurai (The Magnificent Seven) (Shichin...                Action|Drama
3        922   [4.484967]      Sunset Blvd. (a.k.a. Sunset Boulevard) (1950)                   Film-Noir
4        904   [4.472535]                                 Rear Window (1954)            Mystery|Thriller
5        913  [4.4683127]                         Maltese Falcon, The (1941)           Film-Noir|Mystery
6       1221  [4.4355574]                     Godfather: Part II, The (1974)          Action|Crime|Drama
7        745  [4.4340806]                              Close Shave, A (1995)   Animation|Comedy|Thriller
8       1252  [4.4315677]                                   Chinatown (1974)  Film-Noir|Mystery|Thriller
9       1178  [4.4312105]                              Paths of Glory (1957)                   Drama|War
10       720  [4.4185233]  Wallace & Gromit: The Best of Aardman Animatio...                   Animation
11      3030  [4.4156966]                                     Yojimbo (1961)        Comedy|Drama|Western
12      1148   [4.407097]                         Wrong Trousers, The (1993)            Animation|Comedy
13      3435  [4.4064903]                            Double Indemnity (1944)             Crime|Film-Noir
14      1223  [4.3942194]                            Grand Day Out, A (1992)            Animation|Comedy
15      1212  [4.3873863]                              Third Man, The (1949)            Mystery|Thriller
16      1204  [4.3843093]                          Lawrence of Arabia (1962)               Adventure|War
17      3022   [4.382555]                                General, The (1927)                      Comedy
18      3307   [4.381924]                                 City Lights (1931)        Comedy|Drama|Romance
19       750   [4.380474]  Dr. Strangelove or: How I Learned to Stop Worr...                  Sci-Fi|War
build_model: multiply, dense layers: [64, 32, 1]

Model Summary

Model Parameters:
	merge layer: multiply
	embedding size: 50
	dense layers: [64, 32, 1]

Save name: multiply_50_64_32_1.h5
Model: "functional_17"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_17 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
input_18 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
embedding_16 (Embedding)        (None, 1, 50)        302000      input_17[0][0]                   
__________________________________________________________________________________________________
embedding_17 (Embedding)        (None, 1, 50)        197600      input_18[0][0]                   
__________________________________________________________________________________________________
multiply (Multiply)             (None, 1, 50)        0           embedding_16[0][0]               
                                                                 embedding_17[0][0]               
__________________________________________________________________________________________________
dense_24 (Dense)                (None, 1, 64)        3264        multiply[0][0]                   
__________________________________________________________________________________________________
dense_25 (Dense)                (None, 1, 32)        2080        dense_24[0][0]                   
__________________________________________________________________________________________________
dense_26 (Dense)                (None, 1, 1)         33          dense_25[0][0]                   
==================================================================================================
Total params: 504,977
Trainable params: 504,977
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/30
28131/28131 - 65s - loss: 1.2676 - val_loss: 1.2481
Epoch 2/30
28131/28131 - 64s - loss: 1.1274 - val_loss: 1.0517
Epoch 3/30
28131/28131 - 65s - loss: 0.9032 - val_loss: 0.9413
Epoch 4/30
28131/28131 - 65s - loss: 0.7871 - val_loss: 0.9034
Epoch 5/30
28131/28131 - 65s - loss: 0.7152 - val_loss: 0.8875
Epoch 6/30
28131/28131 - 64s - loss: 0.6624 - val_loss: 0.8825
Epoch 7/30
28131/28131 - 65s - loss: 0.6209 - val_loss: 0.8803
Epoch 8/30
28131/28131 - 64s - loss: 0.5869 - val_loss: 0.8816
Epoch 9/30
28131/28131 - 64s - loss: 0.5586 - val_loss: 0.8852
Minimum RMSE at epoch 7 = 0.9382

Model Evaluation

build_model: multiply, dense layers: [64, 32, 1]

Display Predicted User Ratings and Actual Ratings

    user_id  movie_id  rating   prediction                                   title                        genres
0      2000      1639       5  [3.4101572]                      Chasing Amy (1997)                 Drama|Romance
1      2000      2529       5  [4.4489403]               Planet of the Apes (1968)                 Action|Sci-Fi
2      2000      1136       5  [4.2044077]  Monty Python and the Holy Grail (1974)                        Comedy
3      2000      2321       5  [3.9053853]                    Pleasantville (1998)                        Comedy
4      2000      2858       5   [4.204763]                  American Beauty (1999)                  Comedy|Drama
5      2000      2501       5  [3.8838418]                      October Sky (1999)                         Drama
6      2000      2804       5   [4.088927]               Christmas Story, A (1983)                  Comedy|Drama
7      2000      1688       5  [4.3278446]                        Anastasia (1997)  Animation|Children's|Musical
8      2000      1653       5  [4.1286283]                          Gattaca (1997)         Drama|Sci-Fi|Thriller
9      2000       527       5  [4.2899776]                 Schindler's List (1993)                     Drama|War
10     2000      1619       5   [4.119199]             Seven Years in Tibet (1997)                     Drama|War
11     2000       110       5    [4.09001]                       Braveheart (1995)              Action|Drama|War
12     2000      1193       5  [4.7779675]  One Flew Over the Cuckoo's Nest (1975)                         Drama
13     2000       318       5   [4.590307]        Shawshank Redemption, The (1994)                         Drama
14     2000      1748       5    [4.14323]                        Dark City (1998)     Film-Noir|Sci-Fi|Thriller
15     2000      1923       5  [3.0843728]     There's Something About Mary (1998)                        Comedy
16     2000      1259       5   [4.281972]                      Stand by Me (1986)        Adventure|Comedy|Drama
17     2000       595       5  [4.1383862]             Beauty and the Beast (1991)  Animation|Children's|Musical
18     2000      2028       5  [4.4607944]              Saving Private Ryan (1998)              Action|Drama|War
19     2000      1907       5  [4.0436077]                            Mulan (1998)          Animation|Children's

Display Predicted User Ratings for Recommendation

    movie_id   prediction                                 title                              genres
0       1035  [5.5246778]            Sound of Music, The (1965)                             Musical
1        928   [5.299903]                        Rebecca (1940)                    Romance|Thriller
2       3135  [5.1807523]             Great Santini, The (1979)                               Drama
3       1206  [5.1557913]            Clockwork Orange, A (1971)                              Sci-Fi
4        932   [5.154748]         Affair to Remember, An (1957)                             Romance
5        898  [5.1416726]        Philadelphia Story, The (1940)                      Comedy|Romance
6       1250   [5.138206]  Bridge on the River Kwai, The (1957)                           Drama|War
7       3789    [5.12309]                Pawnbroker, The (1965)                               Drama
8       1299  [5.0853477]            Killing Fields, The (1984)                           Drama|War
9        919   [5.030471]              Wizard of Oz, The (1939)  Adventure|Children's|Drama|Musical
10      3499   [5.025811]                         Misery (1990)                              Horror
11      1204  [5.0198474]             Lawrence of Arabia (1962)                       Adventure|War
12      1945   [5.010613]              On the Waterfront (1954)                         Crime|Drama
13       904  [4.9996843]                    Rear Window (1954)                    Mystery|Thriller
14      1952  [4.9983697]                Midnight Cowboy (1969)                               Drama
15      1950  [4.9754286]       In the Heat of the Night (1967)                       Drama|Mystery
16      3365   [4.974625]                 Searchers, The (1956)                             Western
17      3467  [4.9740715]                            Hud (1963)                       Drama|Western
18      3801  [4.9692607]            Anatomy of a Murder (1959)                       Drama|Mystery
19      1947   [4.955718]                West Side Story (1961)                     Musical|Romance
build_model: multiply, dense layers: [32, 16, 1]

Model Summary

Model Parameters:
	merge layer: multiply
	embedding size: 50
	dense layers: [32, 16, 1]

Save name: multiply_50_32_16_1.h5
Model: "functional_21"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_21 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
input_22 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
embedding_20 (Embedding)        (None, 1, 50)        302000      input_21[0][0]                   
__________________________________________________________________________________________________
embedding_21 (Embedding)        (None, 1, 50)        197600      input_22[0][0]                   
__________________________________________________________________________________________________
multiply_2 (Multiply)           (None, 1, 50)        0           embedding_20[0][0]               
                                                                 embedding_21[0][0]               
__________________________________________________________________________________________________
dense_30 (Dense)                (None, 1, 32)        1632        multiply_2[0][0]                 
__________________________________________________________________________________________________
dense_31 (Dense)                (None, 1, 16)        528         dense_30[0][0]                   
__________________________________________________________________________________________________
dense_32 (Dense)                (None, 1, 1)         17          dense_31[0][0]                   
==================================================================================================
Total params: 501,777
Trainable params: 501,777
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/30
28131/28131 - 63s - loss: 1.2781 - val_loss: 1.2475
Epoch 2/30
28131/28131 - 64s - loss: 1.1172 - val_loss: 1.0488
Epoch 3/30
28131/28131 - 64s - loss: 0.8980 - val_loss: 0.9459
Epoch 4/30
28131/28131 - 63s - loss: 0.7812 - val_loss: 0.9077
Epoch 5/30
28131/28131 - 64s - loss: 0.7094 - val_loss: 0.8942
Epoch 6/30
28131/28131 - 64s - loss: 0.6569 - val_loss: 0.8890
Epoch 7/30
28131/28131 - 63s - loss: 0.6160 - val_loss: 0.8806
Epoch 8/30
28131/28131 - 63s - loss: 0.5827 - val_loss: 0.8832
Epoch 9/30
28131/28131 - 63s - loss: 0.5550 - val_loss: 0.8930
Minimum RMSE at epoch 7 = 0.9384

Model Evaluation

build_model: multiply, dense layers: [32, 16, 1]

Display Predicted User Ratings and Actual Ratings

    user_id  movie_id  rating   prediction                                   title                        genres
0      2000      1639       5  [3.4268596]                      Chasing Amy (1997)                 Drama|Romance
1      2000      2529       5  [4.0584617]               Planet of the Apes (1968)                 Action|Sci-Fi
2      2000      1136       5  [4.2613235]  Monty Python and the Holy Grail (1974)                        Comedy
3      2000      2321       5   [4.285929]                    Pleasantville (1998)                        Comedy
4      2000      2858       5  [4.5752726]                  American Beauty (1999)                  Comedy|Drama
5      2000      2501       5   [4.389666]                      October Sky (1999)                         Drama
6      2000      2804       5  [4.1638074]               Christmas Story, A (1983)                  Comedy|Drama
7      2000      1688       5  [3.7323635]                        Anastasia (1997)  Animation|Children's|Musical
8      2000      1653       5  [3.5657208]                          Gattaca (1997)         Drama|Sci-Fi|Thriller
9      2000       527       5  [4.1734567]                 Schindler's List (1993)                     Drama|War
10     2000      1619       5   [4.011713]             Seven Years in Tibet (1997)                     Drama|War
11     2000       110       5   [4.082812]                       Braveheart (1995)              Action|Drama|War
12     2000      1193       5   [4.174409]  One Flew Over the Cuckoo's Nest (1975)                         Drama
13     2000       318       5   [4.608924]        Shawshank Redemption, The (1994)                         Drama
14     2000      1748       5   [4.661808]                        Dark City (1998)     Film-Noir|Sci-Fi|Thriller
15     2000      1923       5   [4.417941]     There's Something About Mary (1998)                        Comedy
16     2000      1259       5  [4.0112047]                      Stand by Me (1986)        Adventure|Comedy|Drama
17     2000       595       5  [4.0882626]             Beauty and the Beast (1991)  Animation|Children's|Musical
18     2000      2028       5   [4.247538]              Saving Private Ryan (1998)              Action|Drama|War
19     2000      1907       5  [3.7703674]                            Mulan (1998)          Animation|Children's

Display Predicted User Ratings for Recommendation

    movie_id   prediction                                title                        genres
0       1263   [5.427058]              Deer Hunter, The (1978)                     Drama|War
1       1177  [5.1267343]               Enchanted April (1991)                         Drama
2       1959   [4.919675]                 Out of Africa (1985)                 Drama|Romance
3       1357  [4.9154277]                         Shine (1996)                 Drama|Romance
4       1175  [4.8878756]                  Delicatessen (1991)                 Comedy|Sci-Fi
5       1172  [4.8738503]               Cinema Paradiso (1988)          Comedy|Drama|Romance
6        965  [4.8530993]                 39 Steps, The (1935)                      Thriller
7       1230  [4.8304577]                    Annie Hall (1977)                Comedy|Romance
8       3097  [4.8215537]   Shop Around the Corner, The (1940)                Comedy|Romance
9       3462  [4.8215404]                  Modern Times (1936)                        Comedy
10      1500  [4.8023314]           Grosse Pointe Blank (1997)                  Comedy|Crime
11      2066  [4.7913966]               Out of the Past (1947)                     Film-Noir
12      1967   [4.745644]                     Labyrinth (1986)  Adventure|Children's|Fantasy
13      3265  [4.7406287]  Hard-Boiled (Lashou shentan) (1992)                  Action|Crime
14      1078   [4.739193]                       Bananas (1971)                    Comedy|War
15      3618  [4.7301397]             Small Time Crooks (2000)                        Comedy
16      3476  [4.7214613]                Jacob's Ladder (1990)       Horror|Mystery|Thriller
17       111   [4.678389]                   Taxi Driver (1976)                Drama|Thriller
18      1104  [4.6324697]     Streetcar Named Desire, A (1951)                         Drama
19      2067   [4.627987]                Doctor Zhivago (1965)             Drama|Romance|War
build_model: multiply, dense layers: [64, 32, 1]

Model Summary

Model Parameters:
	merge layer: multiply
	embedding size: 100
	dense layers: [64, 32, 1]

Save name: multiply_100_64_32_1.h5
Model: "functional_25"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_25 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
input_26 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
embedding_24 (Embedding)        (None, 1, 100)       604000      input_25[0][0]                   
__________________________________________________________________________________________________
embedding_25 (Embedding)        (None, 1, 100)       395200      input_26[0][0]                   
__________________________________________________________________________________________________
multiply_4 (Multiply)           (None, 1, 100)       0           embedding_24[0][0]               
                                                                 embedding_25[0][0]               
__________________________________________________________________________________________________
dense_36 (Dense)                (None, 1, 64)        6464        multiply_4[0][0]                 
__________________________________________________________________________________________________
dense_37 (Dense)                (None, 1, 32)        2080        dense_36[0][0]                   
__________________________________________________________________________________________________
dense_38 (Dense)                (None, 1, 1)         33          dense_37[0][0]                   
==================================================================================================
Total params: 1,007,777
Trainable params: 1,007,777
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/30
28131/28131 - 69s - loss: 1.2668 - val_loss: 1.2455
Epoch 2/30
28131/28131 - 69s - loss: 1.1042 - val_loss: 1.0558
Epoch 3/30
28131/28131 - 69s - loss: 0.8624 - val_loss: 0.9674
Epoch 4/30
28131/28131 - 69s - loss: 0.7227 - val_loss: 0.9392
Epoch 5/30
28131/28131 - 69s - loss: 0.6295 - val_loss: 0.9387
Epoch 6/30
28131/28131 - 69s - loss: 0.5589 - val_loss: 0.9546
Epoch 7/30
28131/28131 - 69s - loss: 0.5029 - val_loss: 0.9662
Minimum RMSE at epoch 5 = 0.9689

Model Evaluation

build_model: multiply, dense layers: [64, 32, 1]

Display Predicted User Ratings and Actual Ratings

    user_id  movie_id  rating   prediction                                   title                        genres
0      2000      1639       5  [3.3845537]                      Chasing Amy (1997)                 Drama|Romance
1      2000      2529       5   [3.813895]               Planet of the Apes (1968)                 Action|Sci-Fi
2      2000      1136       5  [4.4696774]  Monty Python and the Holy Grail (1974)                        Comedy
3      2000      2321       5  [4.1746564]                    Pleasantville (1998)                        Comedy
4      2000      2858       5   [4.495195]                  American Beauty (1999)                  Comedy|Drama
5      2000      2501       5   [4.373095]                      October Sky (1999)                         Drama
6      2000      2804       5  [4.4018617]               Christmas Story, A (1983)                  Comedy|Drama
7      2000      1688       5   [4.589219]                        Anastasia (1997)  Animation|Children's|Musical
8      2000      1653       5   [4.025276]                          Gattaca (1997)         Drama|Sci-Fi|Thriller
9      2000       527       5   [4.809044]                 Schindler's List (1993)                     Drama|War
10     2000      1619       5   [4.187194]             Seven Years in Tibet (1997)                     Drama|War
11     2000       110       5  [4.5869675]                       Braveheart (1995)              Action|Drama|War
12     2000      1193       5  [4.3512154]  One Flew Over the Cuckoo's Nest (1975)                         Drama
13     2000       318       5  [4.3845863]        Shawshank Redemption, The (1994)                         Drama
14     2000      1748       5  [3.2351823]                        Dark City (1998)     Film-Noir|Sci-Fi|Thriller
15     2000      1923       5  [3.1761785]     There's Something About Mary (1998)                        Comedy
16     2000      1259       5   [4.189348]                      Stand by Me (1986)        Adventure|Comedy|Drama
17     2000       595       5  [4.0315485]             Beauty and the Beast (1991)  Animation|Children's|Musical
18     2000      2028       5  [4.7148886]              Saving Private Ryan (1998)              Action|Drama|War
19     2000      1907       5  [3.8103604]                            Mulan (1998)          Animation|Children's

Display Predicted User Ratings for Recommendation

    movie_id   prediction                                              title                     genres
0       1224   [5.267484]                                     Henry V (1989)                  Drama|War
1        951  [5.1242337]                             His Girl Friday (1940)                     Comedy
2       3203  [5.0277953]                                   Dead Calm (1989)                   Thriller
3       1939    [4.96472]                Best Years of Our Lives, The (1946)                  Drama|War
4        914   [4.893611]                                My Fair Lady (1964)            Musical|Romance
5       2442  [4.8741636]                           Hilary and Jackie (1998)                      Drama
6       1125  [4.8483925]             Return of the Pink Panther, The (1974)                     Comedy
7       1176  [4.8457174]  Double Life of Veronique, The (La Double Vie d...                      Drama
8        905  [4.8313904]                       It Happened One Night (1934)                     Comedy
9       2423    [4.81895]                          Christmas Vacation (1989)                     Comedy
10       141  [4.8133698]                               Birdcage, The (1996)                     Comedy
11      1304  [4.8118124]          Butch Cassidy and the Sundance Kid (1969)      Action|Comedy|Western
12       899  [4.7988706]                         Singin' in the Rain (1952)            Musical|Romance
13       456   [4.795443]                                       Fresh (1994)                      Drama
14      2150  [4.7946362]                     Gods Must Be Crazy, The (1980)                     Comedy
15      1111    [4.78231]  Microcosmos (Microcosmos: Le peuple de l'herbe...                Documentary
16      1028  [4.7612844]                                Mary Poppins (1964)  Children's|Comedy|Musical
17      1041   [4.754385]                              Secrets & Lies (1996)                      Drama
18      2300    [4.75326]                              Producers, The (1968)             Comedy|Musical
19      1035   [4.753146]                         Sound of Music, The (1965)                    Musical
build_model: multiply, dense layers: [32, 16, 1]

Model Summary

Model Parameters:
	merge layer: multiply
	embedding size: 100
	dense layers: [32, 16, 1]

Save name: multiply_100_32_16_1.h5
Model: "functional_29"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_29 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
input_30 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
embedding_28 (Embedding)        (None, 1, 100)       604000      input_29[0][0]                   
__________________________________________________________________________________________________
embedding_29 (Embedding)        (None, 1, 100)       395200      input_30[0][0]                   
__________________________________________________________________________________________________
multiply_6 (Multiply)           (None, 1, 100)       0           embedding_28[0][0]               
                                                                 embedding_29[0][0]               
__________________________________________________________________________________________________
dense_42 (Dense)                (None, 1, 32)        3232        multiply_6[0][0]                 
__________________________________________________________________________________________________
dense_43 (Dense)                (None, 1, 16)        528         dense_42[0][0]                   
__________________________________________________________________________________________________
dense_44 (Dense)                (None, 1, 1)         17          dense_43[0][0]                   
==================================================================================================
Total params: 1,002,977
Trainable params: 1,002,977
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/30
28131/28131 - 66s - loss: 1.2732 - val_loss: 1.2387
Epoch 2/30
28131/28131 - 66s - loss: 1.0733 - val_loss: 1.0251
Epoch 3/30
28131/28131 - 66s - loss: 0.8345 - val_loss: 0.9606
Epoch 4/30
28131/28131 - 68s - loss: 0.7033 - val_loss: 0.9557
Epoch 5/30
28131/28131 - 67s - loss: 0.6139 - val_loss: 0.9442
Epoch 6/30
28131/28131 - 66s - loss: 0.5462 - val_loss: 0.9505
Epoch 7/30
28131/28131 - 67s - loss: 0.4926 - val_loss: 0.9681
Minimum RMSE at epoch 5 = 0.9717

Model Evaluation

build_model: multiply, dense layers: [32, 16, 1]

Display Predicted User Ratings and Actual Ratings

    user_id  movie_id  rating   prediction                                   title                        genres
0      2000      1639       5   [3.701104]                      Chasing Amy (1997)                 Drama|Romance
1      2000      2529       5  [4.6175904]               Planet of the Apes (1968)                 Action|Sci-Fi
2      2000      1136       5  [4.6141257]  Monty Python and the Holy Grail (1974)                        Comedy
3      2000      2321       5  [3.2505214]                    Pleasantville (1998)                        Comedy
4      2000      2858       5    [4.41498]                  American Beauty (1999)                  Comedy|Drama
5      2000      2501       5  [4.8982615]                      October Sky (1999)                         Drama
6      2000      2804       5   [4.296901]               Christmas Story, A (1983)                  Comedy|Drama
7      2000      1688       5   [4.460263]                        Anastasia (1997)  Animation|Children's|Musical
8      2000      1653       5  [3.9785788]                          Gattaca (1997)         Drama|Sci-Fi|Thriller
9      2000       527       5  [4.4630594]                 Schindler's List (1993)                     Drama|War
10     2000      1619       5  [4.0827403]             Seven Years in Tibet (1997)                     Drama|War
11     2000       110       5  [4.6404552]                       Braveheart (1995)              Action|Drama|War
12     2000      1193       5  [4.8943954]  One Flew Over the Cuckoo's Nest (1975)                         Drama
13     2000       318       5  [4.9186144]        Shawshank Redemption, The (1994)                         Drama
14     2000      1748       5  [4.1053944]                        Dark City (1998)     Film-Noir|Sci-Fi|Thriller
15     2000      1923       5  [3.5412486]     There's Something About Mary (1998)                        Comedy
16     2000      1259       5  [4.3481655]                      Stand by Me (1986)        Adventure|Comedy|Drama
17     2000       595       5  [4.0494657]             Beauty and the Beast (1991)  Animation|Children's|Musical
18     2000      2028       5   [4.754854]              Saving Private Ryan (1998)              Action|Drama|War
19     2000      1907       5  [4.1586056]                            Mulan (1998)          Animation|Children's

Display Predicted User Ratings for Recommendation

    movie_id   prediction                                    title                         genres
0        249   [5.383904]                  Immortal Beloved (1994)                  Drama|Romance
1       3416  [5.1388626]            Trial, The (Le Procès) (1963)                          Drama
2       3198   [5.091827]                          Papillon (1973)                          Drama
3       1203  [5.0814104]                      12 Angry Men (1957)                          Drama
4        924  [5.0690846]             2001: A Space Odyssey (1968)  Drama|Mystery|Sci-Fi|Thriller
5       3683   [5.057289]                      Blood Simple (1984)                Drama|Film-Noir
6        954   [5.023863]      Mr. Smith Goes to Washington (1939)                          Drama
7        745    [5.00836]                    Close Shave, A (1995)      Animation|Comedy|Thriller
8       1921  [4.9912953]                                Pi (1998)                Sci-Fi|Thriller
9       1148  [4.9881454]               Wrong Trousers, The (1993)               Animation|Comedy
10       562  [4.9450355]          Welcome to the Dollhouse (1995)                   Comedy|Drama
11      3548   [4.944958]                       Auntie Mame (1958)                   Comedy|Drama
12      1281  [4.9292927]               Great Dictator, The (1940)                         Comedy
13      1734  [4.8995776]  My Life in Pink (Ma vie en rose) (1997)                   Comedy|Drama
14      3507  [4.8928514]                   Odd Couple, The (1968)                         Comedy
15      1287   [4.883979]                           Ben-Hur (1959)         Action|Adventure|Drama
16      1253  [4.8759212]    Day the Earth Stood Still, The (1951)                   Drama|Sci-Fi
17       608  [4.8626785]                             Fargo (1996)           Crime|Drama|Thriller
18      1301  [4.8612256]                  Forbidden Planet (1956)                         Sci-Fi
19      1278  [4.8611603]                Young Frankenstein (1974)                  Comedy|Horror
build_model: average, dense layers: [64, 32, 1]

Model Summary

Model Parameters:
	merge layer: average
	embedding size: 50
	dense layers: [64, 32, 1]

Save name: average_50_64_32_1.h5
Model: "functional_33"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_33 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
input_34 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
embedding_32 (Embedding)        (None, 1, 50)        302000      input_33[0][0]                   
__________________________________________________________________________________________________
embedding_33 (Embedding)        (None, 1, 50)        197600      input_34[0][0]                   
__________________________________________________________________________________________________
average (Average)               (None, 1, 50)        0           embedding_32[0][0]               
                                                                 embedding_33[0][0]               
__________________________________________________________________________________________________
dense_48 (Dense)                (None, 1, 64)        3264        average[0][0]                    
__________________________________________________________________________________________________
dense_49 (Dense)                (None, 1, 32)        2080        dense_48[0][0]                   
__________________________________________________________________________________________________
dense_50 (Dense)                (None, 1, 1)         33          dense_49[0][0]                   
==================================================================================================
Total params: 504,977
Trainable params: 504,977
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/30
28131/28131 - 65s - loss: 0.9196 - val_loss: 0.8396
Epoch 2/30
28131/28131 - 66s - loss: 0.8342 - val_loss: 0.8334
Epoch 3/30
28131/28131 - 65s - loss: 0.8283 - val_loss: 0.8350
Epoch 4/30
28131/28131 - 66s - loss: 0.8257 - val_loss: 0.8312
Epoch 5/30
28131/28131 - 66s - loss: 0.8242 - val_loss: 0.8311
Epoch 6/30
28131/28131 - 66s - loss: 0.8228 - val_loss: 0.8284
Epoch 7/30
28131/28131 - 65s - loss: 0.8218 - val_loss: 0.8331
Epoch 8/30
28131/28131 - 65s - loss: 0.8210 - val_loss: 0.8278
Epoch 9/30
28131/28131 - 65s - loss: 0.8204 - val_loss: 0.8266
Epoch 10/30
28131/28131 - 65s - loss: 0.8197 - val_loss: 0.8290
Epoch 11/30
28131/28131 - 65s - loss: 0.8193 - val_loss: 0.8276
Minimum RMSE at epoch 9 = 0.9092

Model Evaluation

build_model: average, dense layers: [64, 32, 1]

Display Predicted User Ratings and Actual Ratings

    user_id  movie_id  rating   prediction                                   title                        genres
0      2000      1639       5  [3.7617054]                      Chasing Amy (1997)                 Drama|Romance
1      2000      2529       5  [3.7447078]               Planet of the Apes (1968)                 Action|Sci-Fi
2      2000      1136       5  [4.2699256]  Monty Python and the Holy Grail (1974)                        Comedy
3      2000      2321       5  [3.5929248]                    Pleasantville (1998)                        Comedy
4      2000      2858       5   [4.332365]                  American Beauty (1999)                  Comedy|Drama
5      2000      2501       5   [4.115762]                      October Sky (1999)                         Drama
6      2000      2804       5  [4.1905046]               Christmas Story, A (1983)                  Comedy|Drama
7      2000      1688       5  [3.3784816]                        Anastasia (1997)  Animation|Children's|Musical
8      2000      1653       5  [3.6604881]                          Gattaca (1997)         Drama|Sci-Fi|Thriller
9      2000       527       5  [4.6690464]                 Schindler's List (1993)                     Drama|War
10     2000      1619       5  [3.4161515]             Seven Years in Tibet (1997)                     Drama|War
11     2000       110       5   [4.156379]                       Braveheart (1995)              Action|Drama|War
12     2000      1193       5  [4.4881215]  One Flew Over the Cuckoo's Nest (1975)                         Drama
13     2000       318       5  [4.4701133]        Shawshank Redemption, The (1994)                         Drama
14     2000      1748       5  [3.8200674]                        Dark City (1998)     Film-Noir|Sci-Fi|Thriller
15     2000      1923       5  [3.9642618]     There's Something About Mary (1998)                        Comedy
16     2000      1259       5    [4.02083]                      Stand by Me (1986)        Adventure|Comedy|Drama
17     2000       595       5  [3.9063551]             Beauty and the Beast (1991)  Animation|Children's|Musical
18     2000      2028       5   [4.417926]              Saving Private Ryan (1998)              Action|Drama|War
19     2000      1907       5   [3.665894]                            Mulan (1998)          Animation|Children's

Display Predicted User Ratings for Recommendation

    movie_id   prediction                                              title                     genres
0       2905  [4.5957675]                                     Sanjuro (1962)           Action|Adventure
1        904   [4.569083]                                 Rear Window (1954)           Mystery|Thriller
2        745  [4.5433917]                              Close Shave, A (1995)  Animation|Comedy|Thriller
3        922  [4.5406847]      Sunset Blvd. (a.k.a. Sunset Boulevard) (1950)                  Film-Noir
4        858  [4.5265965]                              Godfather, The (1972)         Action|Crime|Drama
5        912   [4.518132]                                  Casablanca (1942)          Drama|Romance|War
6       1148   [4.516509]                         Wrong Trousers, The (1993)           Animation|Comedy
7        923   [4.512442]                                Citizen Kane (1941)                      Drama
8       2019   [4.495162]  Seven Samurai (The Magnificent Seven) (Shichin...               Action|Drama
9       1212  [4.4908814]                              Third Man, The (1949)           Mystery|Thriller
10      1178  [4.4754148]                              Paths of Glory (1957)                  Drama|War
11      3435   [4.467698]                            Double Indemnity (1944)            Crime|Film-Noir
12      1262   [4.457784]                           Great Escape, The (1963)              Adventure|War
13      1250   [4.457671]               Bridge on the River Kwai, The (1957)                  Drama|War
14      1204   [4.435218]                          Lawrence of Arabia (1962)              Adventure|War
15      1207  [4.4330077]                       To Kill a Mockingbird (1962)                      Drama
16      1284  [4.4292235]                              Big Sleep, The (1946)          Film-Noir|Mystery
17      3022   [4.421621]                                General, The (1927)                     Comedy
18       720   [4.421102]  Wallace & Gromit: The Best of Aardman Animatio...                  Animation
19       750  [4.4192085]  Dr. Strangelove or: How I Learned to Stop Worr...                 Sci-Fi|War
build_model: average, dense layers: [32, 16, 1]

Model Summary

Model Parameters:
	merge layer: average
	embedding size: 50
	dense layers: [32, 16, 1]

Save name: average_50_32_16_1.h5
Model: "functional_37"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_37 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
input_38 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
embedding_36 (Embedding)        (None, 1, 50)        302000      input_37[0][0]                   
__________________________________________________________________________________________________
embedding_37 (Embedding)        (None, 1, 50)        197600      input_38[0][0]                   
__________________________________________________________________________________________________
average_2 (Average)             (None, 1, 50)        0           embedding_36[0][0]               
                                                                 embedding_37[0][0]               
__________________________________________________________________________________________________
dense_54 (Dense)                (None, 1, 32)        1632        average_2[0][0]                  
__________________________________________________________________________________________________
dense_55 (Dense)                (None, 1, 16)        528         dense_54[0][0]                   
__________________________________________________________________________________________________
dense_56 (Dense)                (None, 1, 1)         17          dense_55[0][0]                   
==================================================================================================
Total params: 501,777
Trainable params: 501,777
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/30
28131/28131 - 63s - loss: 0.9264 - val_loss: 0.8420
Epoch 2/30
28131/28131 - 63s - loss: 0.8332 - val_loss: 0.8383
Epoch 3/30
28131/28131 - 64s - loss: 0.8275 - val_loss: 0.8344
Epoch 4/30
28131/28131 - 64s - loss: 0.8249 - val_loss: 0.8300
Epoch 5/30
28131/28131 - 64s - loss: 0.8234 - val_loss: 0.8308
Epoch 6/30
28131/28131 - 64s - loss: 0.8223 - val_loss: 0.8299
Epoch 7/30
28131/28131 - 64s - loss: 0.8214 - val_loss: 0.8282
Epoch 8/30
28131/28131 - 64s - loss: 0.8206 - val_loss: 0.8284
Epoch 9/30
28131/28131 - 63s - loss: 0.8200 - val_loss: 0.8262
Epoch 10/30
28131/28131 - 64s - loss: 0.8196 - val_loss: 0.8268
Epoch 11/30
28131/28131 - 64s - loss: 0.8189 - val_loss: 0.8265
Minimum RMSE at epoch 9 = 0.9089

Model Evaluation

build_model: average, dense layers: [32, 16, 1]

Display Predicted User Ratings and Actual Ratings

    user_id  movie_id  rating   prediction                                   title                        genres
0      2000      1639       5   [3.839699]                      Chasing Amy (1997)                 Drama|Romance
1      2000      2529       5  [3.7613893]               Planet of the Apes (1968)                 Action|Sci-Fi
2      2000      1136       5   [4.349967]  Monty Python and the Holy Grail (1974)                        Comedy
3      2000      2321       5   [3.704306]                    Pleasantville (1998)                        Comedy
4      2000      2858       5   [4.228986]                  American Beauty (1999)                  Comedy|Drama
5      2000      2501       5   [4.038146]                      October Sky (1999)                         Drama
6      2000      2804       5   [4.121048]               Christmas Story, A (1983)                  Comedy|Drama
7      2000      1688       5  [3.3827095]                        Anastasia (1997)  Animation|Children's|Musical
8      2000      1653       5  [3.7586493]                          Gattaca (1997)         Drama|Sci-Fi|Thriller
9      2000       527       5   [4.472049]                 Schindler's List (1993)                     Drama|War
10     2000      1619       5  [3.4565804]             Seven Years in Tibet (1997)                     Drama|War
11     2000       110       5   [4.375464]                       Braveheart (1995)              Action|Drama|War
12     2000      1193       5    [4.40383]  One Flew Over the Cuckoo's Nest (1975)                         Drama
13     2000       318       5  [4.4718323]        Shawshank Redemption, The (1994)                         Drama
14     2000      1748       5  [3.8821008]                        Dark City (1998)     Film-Noir|Sci-Fi|Thriller
15     2000      1923       5   [3.950575]     There's Something About Mary (1998)                        Comedy
16     2000      1259       5   [4.091586]                      Stand by Me (1986)        Adventure|Comedy|Drama
17     2000       595       5    [3.70252]             Beauty and the Beast (1991)  Animation|Children's|Musical
18     2000      2028       5  [4.2571154]              Saving Private Ryan (1998)              Action|Drama|War
19     2000      1907       5  [3.7467394]                            Mulan (1998)          Animation|Children's

Display Predicted User Ratings for Recommendation

    movie_id   prediction                                              title                     genres
0       2905  [4.5518107]                                     Sanjuro (1962)           Action|Adventure
1       2019   [4.510198]  Seven Samurai (The Magnificent Seven) (Shichin...               Action|Drama
2        922  [4.5096893]      Sunset Blvd. (a.k.a. Sunset Boulevard) (1950)                  Film-Noir
3        913   [4.487334]                         Maltese Falcon, The (1941)          Film-Noir|Mystery
4        904  [4.4852414]                                 Rear Window (1954)           Mystery|Thriller
5        745   [4.483482]                              Close Shave, A (1995)  Animation|Comedy|Thriller
6        858  [4.4649544]                              Godfather, The (1972)         Action|Crime|Drama
7       1178   [4.455874]                              Paths of Glory (1957)                  Drama|War
8        912  [4.4404984]                                  Casablanca (1942)          Drama|Romance|War
9        923   [4.440325]                                Citizen Kane (1941)                      Drama
10       750  [4.4212594]  Dr. Strangelove or: How I Learned to Stop Worr...                 Sci-Fi|War
11       720  [4.4184575]  Wallace & Gromit: The Best of Aardman Animatio...                  Animation
12      1212  [4.4028254]                              Third Man, The (1949)           Mystery|Thriller
13      3089  [4.3910923]    Bicycle Thief, The (Ladri di biciclette) (1948)                      Drama
14      3030   [4.389586]                                     Yojimbo (1961)       Comedy|Drama|Western
15      1148  [4.3875427]                         Wrong Trousers, The (1993)           Animation|Comedy
16       908    [4.38701]                          North by Northwest (1959)             Drama|Thriller
17      1262    [4.38651]                           Great Escape, The (1963)              Adventure|War
18       910   [4.383813]                            Some Like It Hot (1959)               Comedy|Crime
19      1221  [4.3733077]                     Godfather: Part II, The (1974)         Action|Crime|Drama
build_model: average, dense layers: [64, 32, 1]

Model Summary

Model Parameters:
	merge layer: average
	embedding size: 100
	dense layers: [64, 32, 1]

Save name: average_100_64_32_1.h5
Model: "functional_41"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_41 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
input_42 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
embedding_40 (Embedding)        (None, 1, 100)       604000      input_41[0][0]                   
__________________________________________________________________________________________________
embedding_41 (Embedding)        (None, 1, 100)       395200      input_42[0][0]                   
__________________________________________________________________________________________________
average_4 (Average)             (None, 1, 100)       0           embedding_40[0][0]               
                                                                 embedding_41[0][0]               
__________________________________________________________________________________________________
dense_60 (Dense)                (None, 1, 64)        6464        average_4[0][0]                  
__________________________________________________________________________________________________
dense_61 (Dense)                (None, 1, 32)        2080        dense_60[0][0]                   
__________________________________________________________________________________________________
dense_62 (Dense)                (None, 1, 1)         33          dense_61[0][0]                   
==================================================================================================
Total params: 1,007,777
Trainable params: 1,007,777
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/30
28131/28131 - 69s - loss: 0.9097 - val_loss: 0.8399
Epoch 2/30
28131/28131 - 71s - loss: 0.8349 - val_loss: 0.8353
Epoch 3/30
28131/28131 - 70s - loss: 0.8295 - val_loss: 0.8360
Epoch 4/30
28131/28131 - 70s - loss: 0.8266 - val_loss: 0.8327
Epoch 5/30
28131/28131 - 69s - loss: 0.8249 - val_loss: 0.8315
Epoch 6/30
28131/28131 - 70s - loss: 0.8235 - val_loss: 0.8304
Epoch 7/30
28131/28131 - 69s - loss: 0.8223 - val_loss: 0.8316
Epoch 8/30
28131/28131 - 69s - loss: 0.8216 - val_loss: 0.8286
Epoch 9/30
28131/28131 - 70s - loss: 0.8211 - val_loss: 0.8316
Epoch 10/30
28131/28131 - 71s - loss: 0.8203 - val_loss: 0.8275
Epoch 11/30
28131/28131 - 69s - loss: 0.8198 - val_loss: 0.8280
Epoch 12/30
28131/28131 - 70s - loss: 0.8194 - val_loss: 0.8278
Minimum RMSE at epoch 10 = 0.9097

Model Evaluation

build_model: average, dense layers: [64, 32, 1]

Display Predicted User Ratings and Actual Ratings

    user_id  movie_id  rating   prediction                                   title                        genres
0      2000      1639       5  [3.7125545]                      Chasing Amy (1997)                 Drama|Romance
1      2000      2529       5  [3.7202313]               Planet of the Apes (1968)                 Action|Sci-Fi
2      2000      1136       5   [4.310809]  Monty Python and the Holy Grail (1974)                        Comedy
3      2000      2321       5  [3.6354444]                    Pleasantville (1998)                        Comedy
4      2000      2858       5   [4.336749]                  American Beauty (1999)                  Comedy|Drama
5      2000      2501       5   [4.137828]                      October Sky (1999)                         Drama
6      2000      2804       5   [4.265463]               Christmas Story, A (1983)                  Comedy|Drama
7      2000      1688       5  [3.4811807]                        Anastasia (1997)  Animation|Children's|Musical
8      2000      1653       5  [3.7838328]                          Gattaca (1997)         Drama|Sci-Fi|Thriller
9      2000       527       5   [4.586887]                 Schindler's List (1993)                     Drama|War
10     2000      1619       5  [3.4727736]             Seven Years in Tibet (1997)                     Drama|War
11     2000       110       5   [4.222331]                       Braveheart (1995)              Action|Drama|War
12     2000      1193       5  [4.4705615]  One Flew Over the Cuckoo's Nest (1975)                         Drama
13     2000       318       5  [4.6263933]        Shawshank Redemption, The (1994)                         Drama
14     2000      1748       5  [3.8640609]                        Dark City (1998)     Film-Noir|Sci-Fi|Thriller
15     2000      1923       5  [3.9828513]     There's Something About Mary (1998)                        Comedy
16     2000      1259       5   [4.045448]                      Stand by Me (1986)        Adventure|Comedy|Drama
17     2000       595       5  [3.9329011]             Beauty and the Beast (1991)  Animation|Children's|Musical
18     2000      2028       5  [4.3550825]              Saving Private Ryan (1998)              Action|Drama|War
19     2000      1907       5   [3.740286]                            Mulan (1998)          Animation|Children's

Display Predicted User Ratings for Recommendation

    movie_id   prediction                                              title                     genres
0       2905   [4.682873]                                     Sanjuro (1962)           Action|Adventure
1       1148  [4.6123943]                         Wrong Trousers, The (1993)           Animation|Comedy
2        858    [4.60248]                              Godfather, The (1972)         Action|Crime|Drama
3        745    [4.59618]                              Close Shave, A (1995)  Animation|Comedy|Thriller
4        922  [4.5844097]      Sunset Blvd. (a.k.a. Sunset Boulevard) (1950)                  Film-Noir
5       2019  [4.5447583]  Seven Samurai (The Magnificent Seven) (Shichin...               Action|Drama
6        904   [4.526371]                                 Rear Window (1954)           Mystery|Thriller
7       1178  [4.5218363]                              Paths of Glory (1957)                  Drama|War
8       3435    [4.51189]                            Double Indemnity (1944)            Crime|Film-Noir
9        720   [4.503269]  Wallace & Gromit: The Best of Aardman Animatio...                  Animation
10       908   [4.492425]                          North by Northwest (1959)             Drama|Thriller
11       750  [4.4825873]  Dr. Strangelove or: How I Learned to Stop Worr...                 Sci-Fi|War
12      1267   [4.474095]                   Manchurian Candidate, The (1962)         Film-Noir|Thriller
13      1212  [4.4731708]                              Third Man, The (1949)           Mystery|Thriller
14       913  [4.4645114]                         Maltese Falcon, The (1941)          Film-Noir|Mystery
15      1204   [4.459336]                          Lawrence of Arabia (1962)              Adventure|War
16       953  [4.4526925]                       It's a Wonderful Life (1946)                      Drama
17      1284   [4.450259]                              Big Sleep, The (1946)          Film-Noir|Mystery
18       926  [4.4439206]                               All About Eve (1950)                      Drama
19      1260  [4.4423857]                                           M (1931)   Crime|Film-Noir|Thriller
build_model: average, dense layers: [32, 16, 1]

Model Summary

Model Parameters:
	merge layer: average
	embedding size: 100
	dense layers: [32, 16, 1]

Save name: average_100_32_16_1.h5
Model: "functional_45"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_45 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
input_46 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
embedding_44 (Embedding)        (None, 1, 100)       604000      input_45[0][0]                   
__________________________________________________________________________________________________
embedding_45 (Embedding)        (None, 1, 100)       395200      input_46[0][0]                   
__________________________________________________________________________________________________
average_6 (Average)             (None, 1, 100)       0           embedding_44[0][0]               
                                                                 embedding_45[0][0]               
__________________________________________________________________________________________________
dense_66 (Dense)                (None, 1, 32)        3232        average_6[0][0]                  
__________________________________________________________________________________________________
dense_67 (Dense)                (None, 1, 16)        528         dense_66[0][0]                   
__________________________________________________________________________________________________
dense_68 (Dense)                (None, 1, 1)         17          dense_67[0][0]                   
==================================================================================================
Total params: 1,002,977
Trainable params: 1,002,977
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/30
28131/28131 - 66s - loss: 0.9177 - val_loss: 0.8416
Epoch 2/30
28131/28131 - 67s - loss: 0.8337 - val_loss: 0.8380
Epoch 3/30
28131/28131 - 68s - loss: 0.8285 - val_loss: 0.8423
Epoch 4/30
28131/28131 - 68s - loss: 0.8263 - val_loss: 0.8310
Epoch 5/30
28131/28131 - 68s - loss: 0.8243 - val_loss: 0.8299
Epoch 6/30
28131/28131 - 68s - loss: 0.8232 - val_loss: 0.8328
Epoch 7/30
28131/28131 - 68s - loss: 0.8222 - val_loss: 0.8286
Epoch 8/30
28131/28131 - 67s - loss: 0.8213 - val_loss: 0.8283
Epoch 9/30
28131/28131 - 69s - loss: 0.8206 - val_loss: 0.8274
Epoch 10/30
28131/28131 - 67s - loss: 0.8201 - val_loss: 0.8278
Epoch 11/30
28131/28131 - 67s - loss: 0.8194 - val_loss: 0.8269
Epoch 12/30
28131/28131 - 67s - loss: 0.8189 - val_loss: 0.8268
Epoch 13/30
28131/28131 - 68s - loss: 0.8185 - val_loss: 0.8261
Epoch 14/30
28131/28131 - 67s - loss: 0.8182 - val_loss: 0.8256
Epoch 15/30
28131/28131 - 68s - loss: 0.8178 - val_loss: 0.8266
Epoch 16/30
28131/28131 - 68s - loss: 0.8173 - val_loss: 0.8266
Minimum RMSE at epoch 14 = 0.9086

Model Evaluation

build_model: average, dense layers: [32, 16, 1]

Display Predicted User Ratings and Actual Ratings

    user_id  movie_id  rating   prediction                                   title                        genres
0      2000      1639       5  [3.7893565]                      Chasing Amy (1997)                 Drama|Romance
1      2000      2529       5  [3.6707237]               Planet of the Apes (1968)                 Action|Sci-Fi
2      2000      1136       5   [4.273876]  Monty Python and the Holy Grail (1974)                        Comedy
3      2000      2321       5  [3.6770592]                    Pleasantville (1998)                        Comedy
4      2000      2858       5   [4.378319]                  American Beauty (1999)                  Comedy|Drama
5      2000      2501       5  [4.1536665]                      October Sky (1999)                         Drama
6      2000      2804       5  [4.2141705]               Christmas Story, A (1983)                  Comedy|Drama
7      2000      1688       5  [3.4367204]                        Anastasia (1997)  Animation|Children's|Musical
8      2000      1653       5  [3.6679213]                          Gattaca (1997)         Drama|Sci-Fi|Thriller
9      2000       527       5   [4.548003]                 Schindler's List (1993)                     Drama|War
10     2000      1619       5  [3.3431776]             Seven Years in Tibet (1997)                     Drama|War
11     2000       110       5   [4.249011]                       Braveheart (1995)              Action|Drama|War
12     2000      1193       5  [4.4873757]  One Flew Over the Cuckoo's Nest (1975)                         Drama
13     2000       318       5   [4.645081]        Shawshank Redemption, The (1994)                         Drama
14     2000      1748       5   [3.890079]                        Dark City (1998)     Film-Noir|Sci-Fi|Thriller
15     2000      1923       5   [3.952763]     There's Something About Mary (1998)                        Comedy
16     2000      1259       5   [4.156474]                      Stand by Me (1986)        Adventure|Comedy|Drama
17     2000       595       5  [3.9315023]             Beauty and the Beast (1991)  Animation|Children's|Musical
18     2000      2028       5   [4.248603]              Saving Private Ryan (1998)              Action|Drama|War
19     2000      1907       5   [3.822481]                            Mulan (1998)          Animation|Children's

Display Predicted User Ratings for Recommendation

    movie_id   prediction                                              title                     genres
0       2905  [4.6465454]                                     Sanjuro (1962)           Action|Adventure
1        922  [4.5726733]      Sunset Blvd. (a.k.a. Sunset Boulevard) (1950)                  Film-Noir
2       2019   [4.548202]  Seven Samurai (The Magnificent Seven) (Shichin...               Action|Drama
3       1178   [4.543588]                              Paths of Glory (1957)                  Drama|War
4       1148   [4.507606]                         Wrong Trousers, The (1993)           Animation|Comedy
5       1212    [4.49875]                              Third Man, The (1949)           Mystery|Thriller
6        745   [4.494804]                              Close Shave, A (1995)  Animation|Comedy|Thriller
7        858   [4.493376]                              Godfather, The (1972)         Action|Crime|Drama
8        720  [4.4788284]  Wallace & Gromit: The Best of Aardman Animatio...                  Animation
9        750   [4.471967]  Dr. Strangelove or: How I Learned to Stop Worr...                 Sci-Fi|War
10      3435  [4.4551005]                            Double Indemnity (1944)            Crime|Film-Noir
11      1204   [4.452129]                          Lawrence of Arabia (1962)              Adventure|War
12      1250   [4.427055]               Bridge on the River Kwai, The (1957)                  Drama|War
13      3022  [4.4228992]                                General, The (1927)                     Comedy
14      3307  [4.4222045]                                 City Lights (1931)       Comedy|Drama|Romance
15      1203  [4.4203563]                                12 Angry Men (1957)                      Drama
16       912  [4.4194884]                                  Casablanca (1942)          Drama|Romance|War
17      3030  [4.4184046]                                     Yojimbo (1961)       Comedy|Drama|Western
18       904  [4.4120407]                                 Rear Window (1954)           Mystery|Thriller
19      2186  [4.4100013]                        Strangers on a Train (1951)         Film-Noir|Thriller
build_model: dot, dense layers: [64, 32, 1]

Model Summary

Model Parameters:
	merge layer: dot
	embedding size: 50
	dense layers: [64, 32, 1]

Save name: dot_50_64_32_1.h5
Model: "functional_49"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_49 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
input_50 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
embedding_48 (Embedding)        (None, 1, 50)        302000      input_49[0][0]                   
__________________________________________________________________________________________________
embedding_49 (Embedding)        (None, 1, 50)        197600      input_50[0][0]                   
__________________________________________________________________________________________________
dot (Dot)                       (None, 50, 50)       0           embedding_48[0][0]               
                                                                 embedding_49[0][0]               
__________________________________________________________________________________________________
dense_72 (Dense)                (None, 50, 64)       3264        dot[0][0]                        
__________________________________________________________________________________________________
dense_73 (Dense)                (None, 50, 32)       2080        dense_72[0][0]                   
__________________________________________________________________________________________________
dense_74 (Dense)                (None, 50, 1)        33          dense_73[0][0]                   
==================================================================================================
Total params: 504,977
Trainable params: 504,977
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/30
28131/28131 - 113s - loss: 1.2273 - val_loss: 1.1090
Epoch 2/30
28131/28131 - 113s - loss: 1.0343 - val_loss: 0.9999
Epoch 3/30
28131/28131 - 113s - loss: 0.9646 - val_loss: 0.9536
Epoch 4/30
28131/28131 - 113s - loss: 0.9336 - val_loss: 0.9308
Epoch 5/30
28131/28131 - 113s - loss: 0.9149 - val_loss: 0.9170
Epoch 6/30
28131/28131 - 113s - loss: 0.9011 - val_loss: 0.9025
Epoch 7/30
28131/28131 - 113s - loss: 0.8896 - val_loss: 0.9045
Epoch 8/30
28131/28131 - 113s - loss: 0.8801 - val_loss: 0.8830
Epoch 9/30
28131/28131 - 113s - loss: 0.8721 - val_loss: 0.8784
Epoch 10/30
28131/28131 - 113s - loss: 0.8654 - val_loss: 0.8705
Epoch 11/30
28131/28131 - 113s - loss: 0.8591 - val_loss: 0.8654
Epoch 12/30
28131/28131 - 113s - loss: 0.8539 - val_loss: 0.8604
Epoch 13/30
28131/28131 - 113s - loss: 0.8495 - val_loss: 0.8571
Epoch 14/30
28131/28131 - 113s - loss: 0.8459 - val_loss: 0.8534
Epoch 15/30
28131/28131 - 113s - loss: 0.8427 - val_loss: 0.8500
Epoch 16/30
28131/28131 - 113s - loss: 0.8398 - val_loss: 0.8484
Epoch 17/30
28131/28131 - 113s - loss: 0.8380 - val_loss: 0.8477
Epoch 18/30
28131/28131 - 113s - loss: 0.8360 - val_loss: 0.8449
Epoch 19/30
28131/28131 - 113s - loss: 0.8345 - val_loss: 0.8436
Epoch 20/30
28131/28131 - 113s - loss: 0.8330 - val_loss: 0.8420
Epoch 21/30
28131/28131 - 112s - loss: 0.8322 - val_loss: 0.8430
Epoch 22/30
28131/28131 - 113s - loss: 0.8311 - val_loss: 0.8476
Minimum RMSE at epoch 20 = 0.9176

Model Evaluation

build_model: dot, dense layers: [64, 32, 1]

Display Predicted User Ratings and Actual Ratings

    user_id  movie_id  rating   prediction                                   title                        genres
0      2000      1639       5  [3.8033853]                      Chasing Amy (1997)                 Drama|Romance
1      2000      2529       5  [3.6231523]               Planet of the Apes (1968)                 Action|Sci-Fi
2      2000      1136       5  [4.3484583]  Monty Python and the Holy Grail (1974)                        Comedy
3      2000      2321       5  [3.9356952]                    Pleasantville (1998)                        Comedy
4      2000      2858       5  [4.3858943]                  American Beauty (1999)                  Comedy|Drama
5      2000      2501       5     [4.1894]                      October Sky (1999)                         Drama
6      2000      2804       5   [4.261572]               Christmas Story, A (1983)                  Comedy|Drama
7      2000      1688       5  [3.3357992]                        Anastasia (1997)  Animation|Children's|Musical
8      2000      1653       5  [3.7873783]                          Gattaca (1997)         Drama|Sci-Fi|Thriller
9      2000       527       5  [4.3832808]                 Schindler's List (1993)                     Drama|War
10     2000      1619       5  [3.4745717]             Seven Years in Tibet (1997)                     Drama|War
11     2000       110       5  [4.1444554]                       Braveheart (1995)              Action|Drama|War
12     2000      1193       5   [4.343765]  One Flew Over the Cuckoo's Nest (1975)                         Drama
13     2000       318       5   [4.539794]        Shawshank Redemption, The (1994)                         Drama
14     2000      1748       5  [3.8372617]                        Dark City (1998)     Film-Noir|Sci-Fi|Thriller
15     2000      1923       5  [3.8601263]     There's Something About Mary (1998)                        Comedy
16     2000      1259       5   [4.237476]                      Stand by Me (1986)        Adventure|Comedy|Drama
17     2000       595       5  [3.8444443]             Beauty and the Beast (1991)  Animation|Children's|Musical
18     2000      2028       5  [4.1118894]              Saving Private Ryan (1998)              Action|Drama|War
19     2000      1907       5  [3.7444596]                            Mulan (1998)          Animation|Children's

Display Predicted User Ratings for Recommendation

    movie_id   prediction                                       title                genres
0       1795  [5.2835526]         Callejón de los milagros, El (1995)                 Drama
1        787  [5.1090927]          Gate of Heavenly Peace, The (1995)           Documentary
2       2309  [4.9989023]  Inheritors, The (Die Siebtelbauern) (1998)                 Drama
3       3881   [4.989858]                    Bittersweet Motel (2000)           Documentary
4       3607  [4.9789586]                    One Little Indian (1973)  Comedy|Drama|Western
5       1830  [4.9223566]                     Follow the Bitch (1998)                Comedy
6       1724   [4.891466]                           Full Speed (1996)                 Drama
7       3382   [4.885337]                      Song of Freedom (1936)                 Drama
8       3890   [4.875291]                           Back Stage (2000)           Documentary
9       3245  [4.8590126]         I Am Cuba (Soy Cuba/Ya Kuba) (1964)                 Drama
10      1871   [4.837836]            Friend of the Deceased, A (1997)          Comedy|Drama
11      3888   [4.821531]                        Skipped Parts (2000)         Drama|Romance
12       439  [4.8089085]                       Dangerous Game (1993)                 Drama
13       989  [4.7842484]   Schlafes Bruder (Brother of Sleep) (1995)                 Drama
14       684   [4.778657]                              Windows (1980)                 Drama
15       601  [4.7220087]     Wooden Man's Bride, The (Wu Kui) (1994)                 Drama
16      3172   [4.711204]                     Ulysses (Ulisse) (1954)             Adventure
17      3233  [4.7061615]                        Smashing Time (1967)                Comedy
18      3517   [4.691312]                           Bells, The (1926)           Crime|Drama
19       578  [4.6327815]                 Hour of the Pig, The (1993)         Drama|Mystery
build_model: dot, dense layers: [32, 16, 1]

Model Summary

Model Parameters:
	merge layer: dot
	embedding size: 50
	dense layers: [32, 16, 1]

Save name: dot_50_32_16_1.h5
Model: "functional_53"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_53 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
input_54 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
embedding_52 (Embedding)        (None, 1, 50)        302000      input_53[0][0]                   
__________________________________________________________________________________________________
embedding_53 (Embedding)        (None, 1, 50)        197600      input_54[0][0]                   
__________________________________________________________________________________________________
dot_2 (Dot)                     (None, 50, 50)       0           embedding_52[0][0]               
                                                                 embedding_53[0][0]               
__________________________________________________________________________________________________
dense_78 (Dense)                (None, 50, 32)       1632        dot_2[0][0]                      
__________________________________________________________________________________________________
dense_79 (Dense)                (None, 50, 16)       528         dense_78[0][0]                   
__________________________________________________________________________________________________
dense_80 (Dense)                (None, 50, 1)        17          dense_79[0][0]                   
==================================================================================================
Total params: 501,777
Trainable params: 501,777
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/30
28131/28131 - 101s - loss: 1.2388 - val_loss: 1.1204
Epoch 2/30
28131/28131 - 101s - loss: 1.0414 - val_loss: 1.0000
Epoch 3/30
28131/28131 - 101s - loss: 0.9678 - val_loss: 0.9579
Epoch 4/30
28131/28131 - 101s - loss: 0.9364 - val_loss: 0.9360
Epoch 5/30
28131/28131 - 101s - loss: 0.9178 - val_loss: 0.9227
Epoch 6/30
28131/28131 - 101s - loss: 0.9041 - val_loss: 0.9063
Epoch 7/30
28131/28131 - 101s - loss: 0.8927 - val_loss: 0.8958
Epoch 8/30
28131/28131 - 101s - loss: 0.8830 - val_loss: 0.8882
Epoch 9/30
28131/28131 - 101s - loss: 0.8746 - val_loss: 0.8804
Epoch 10/30
28131/28131 - 101s - loss: 0.8672 - val_loss: 0.8729
Epoch 11/30
28131/28131 - 101s - loss: 0.8608 - val_loss: 0.8677
Epoch 12/30
28131/28131 - 101s - loss: 0.8551 - val_loss: 0.8633
Epoch 13/30
28131/28131 - 101s - loss: 0.8506 - val_loss: 0.8614
Epoch 14/30
28131/28131 - 101s - loss: 0.8466 - val_loss: 0.8558
Epoch 15/30
28131/28131 - 101s - loss: 0.8432 - val_loss: 0.8593
Epoch 16/30
28131/28131 - 101s - loss: 0.8404 - val_loss: 0.8488
Epoch 17/30
28131/28131 - 101s - loss: 0.8380 - val_loss: 0.8475
Epoch 18/30
28131/28131 - 101s - loss: 0.8359 - val_loss: 0.8455
Epoch 19/30
28131/28131 - 101s - loss: 0.8343 - val_loss: 0.8441
Epoch 20/30
28131/28131 - 101s - loss: 0.8331 - val_loss: 0.8435
Epoch 21/30
28131/28131 - 101s - loss: 0.8316 - val_loss: 0.8439
Epoch 22/30
28131/28131 - 101s - loss: 0.8307 - val_loss: 0.8411
Epoch 23/30
28131/28131 - 101s - loss: 0.8299 - val_loss: 0.8401
Epoch 24/30
28131/28131 - 101s - loss: 0.8293 - val_loss: 0.8388
Epoch 25/30
28131/28131 - 101s - loss: 0.8285 - val_loss: 0.8381
Epoch 26/30
28131/28131 - 101s - loss: 0.8278 - val_loss: 0.8381
Epoch 27/30
28131/28131 - 101s - loss: 0.8277 - val_loss: 0.8378
Epoch 28/30
28131/28131 - 101s - loss: 0.8271 - val_loss: 0.8372
Epoch 29/30
28131/28131 - 101s - loss: 0.8267 - val_loss: 0.8362
Epoch 30/30
28131/28131 - 101s - loss: 0.8263 - val_loss: 0.8399
Minimum RMSE at epoch 29 = 0.9144

Model Evaluation

build_model: dot, dense layers: [32, 16, 1]

Display Predicted User Ratings and Actual Ratings

    user_id  movie_id  rating   prediction                                   title                        genres
0      2000      1639       5  [3.8927855]                      Chasing Amy (1997)                 Drama|Romance
1      2000      2529       5  [3.7318065]               Planet of the Apes (1968)                 Action|Sci-Fi
2      2000      1136       5  [4.3447413]  Monty Python and the Holy Grail (1974)                        Comedy
3      2000      2321       5  [3.7117267]                    Pleasantville (1998)                        Comedy
4      2000      2858       5  [4.4217844]                  American Beauty (1999)                  Comedy|Drama
5      2000      2501       5   [4.090966]                      October Sky (1999)                         Drama
6      2000      2804       5   [4.174577]               Christmas Story, A (1983)                  Comedy|Drama
7      2000      1688       5   [3.428712]                        Anastasia (1997)  Animation|Children's|Musical
8      2000      1653       5  [3.8035524]                          Gattaca (1997)         Drama|Sci-Fi|Thriller
9      2000       527       5  [4.4936137]                 Schindler's List (1993)                     Drama|War
10     2000      1619       5  [3.4355586]             Seven Years in Tibet (1997)                     Drama|War
11     2000       110       5   [4.121279]                       Braveheart (1995)              Action|Drama|War
12     2000      1193       5   [4.385447]  One Flew Over the Cuckoo's Nest (1975)                         Drama
13     2000       318       5   [4.415463]        Shawshank Redemption, The (1994)                         Drama
14     2000      1748       5  [3.8311272]                        Dark City (1998)     Film-Noir|Sci-Fi|Thriller
15     2000      1923       5  [3.7580457]     There's Something About Mary (1998)                        Comedy
16     2000      1259       5   [4.099151]                      Stand by Me (1986)        Adventure|Comedy|Drama
17     2000       595       5  [3.7997923]             Beauty and the Beast (1991)  Animation|Children's|Musical
18     2000      2028       5   [4.306378]              Saving Private Ryan (1998)              Action|Drama|War
19     2000      1907       5  [3.6583948]                            Mulan (1998)          Animation|Children's

Display Predicted User Ratings for Recommendation

    movie_id   prediction                                              title                genres
0        787   [5.316105]                 Gate of Heavenly Peace, The (1995)           Documentary
1       3172   [5.307817]                            Ulysses (Ulisse) (1954)             Adventure
2       3890   [5.291683]                                  Back Stage (2000)           Documentary
3       3881  [5.2897615]                           Bittersweet Motel (2000)           Documentary
4       3233  [5.2458277]                               Smashing Time (1967)                Comedy
5        989  [5.2063446]          Schlafes Bruder (Brother of Sleep) (1995)                 Drama
6       3607  [5.1924095]                           One Little Indian (1973)  Comedy|Drama|Western
7       1830  [5.1897974]                            Follow the Bitch (1998)                Comedy
8        130  [5.1624374]                                      Angela (1995)                 Drama
9       2309    [5.12356]         Inheritors, The (Die Siebtelbauern) (1998)                 Drama
10      1795   [5.016877]                Callejón de los milagros, El (1995)                 Drama
11       127   [4.957179]  Silence of the Palace, The (Saimt el Qusur) (1...                 Drama
12      2308   [4.938339]                                Detroit 9000 (1973)          Action|Crime
13      3656  [4.8791866]                                       Lured (1947)                 Crime
14      3245   [4.849675]                I Am Cuba (Soy Cuba/Ya Kuba) (1964)                 Drama
15       439    [4.82761]                              Dangerous Game (1993)                 Drama
16      2218   [4.811433]                            Juno and Paycock (1930)                 Drama
17      3382   [4.770769]                             Song of Freedom (1936)                 Drama
18      1871  [4.7497187]                   Friend of the Deceased, A (1997)          Comedy|Drama
19      3888  [4.7162547]                               Skipped Parts (2000)         Drama|Romance
build_model: dot, dense layers: [64, 32, 1]

Model Summary

Model Parameters:
	merge layer: dot
	embedding size: 100
	dense layers: [64, 32, 1]

Save name: dot_100_64_32_1.h5
Model: "functional_57"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_57 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
input_58 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
embedding_56 (Embedding)        (None, 1, 100)       604000      input_57[0][0]                   
__________________________________________________________________________________________________
embedding_57 (Embedding)        (None, 1, 100)       395200      input_58[0][0]                   
__________________________________________________________________________________________________
dot_4 (Dot)                     (None, 100, 100)     0           embedding_56[0][0]               
                                                                 embedding_57[0][0]               
__________________________________________________________________________________________________
dense_84 (Dense)                (None, 100, 64)      6464        dot_4[0][0]                      
__________________________________________________________________________________________________
dense_85 (Dense)                (None, 100, 32)      2080        dense_84[0][0]                   
__________________________________________________________________________________________________
dense_86 (Dense)                (None, 100, 1)       33          dense_85[0][0]                   
==================================================================================================
Total params: 1,007,777
Trainable params: 1,007,777
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/30
28131/28131 - 137s - loss: 1.2231 - val_loss: 1.1166
Epoch 2/30
28131/28131 - 137s - loss: 1.0321 - val_loss: 0.9960
Epoch 3/30
28131/28131 - 135s - loss: 0.9643 - val_loss: 0.9556
Epoch 4/30
28131/28131 - 137s - loss: 0.9339 - val_loss: 0.9306
Epoch 5/30
28131/28131 - 136s - loss: 0.9153 - val_loss: 0.9152
Epoch 6/30
28131/28131 - 136s - loss: 0.9013 - val_loss: 0.9023
Epoch 7/30
28131/28131 - 137s - loss: 0.8899 - val_loss: 0.8941
Epoch 8/30
28131/28131 - 136s - loss: 0.8806 - val_loss: 0.8871
Epoch 9/30
28131/28131 - 136s - loss: 0.8722 - val_loss: 0.8758
Epoch 10/30
28131/28131 - 137s - loss: 0.8652 - val_loss: 0.8707
Epoch 11/30
28131/28131 - 136s - loss: 0.8590 - val_loss: 0.8697
Epoch 12/30
28131/28131 - 136s - loss: 0.8542 - val_loss: 0.8608
Epoch 13/30
28131/28131 - 136s - loss: 0.8498 - val_loss: 0.8576
Epoch 14/30
28131/28131 - 137s - loss: 0.8458 - val_loss: 0.8546
Epoch 15/30
28131/28131 - 136s - loss: 0.8427 - val_loss: 0.8507
Epoch 16/30
28131/28131 - 137s - loss: 0.8402 - val_loss: 0.8534
Epoch 17/30
28131/28131 - 138s - loss: 0.8378 - val_loss: 0.8455
Epoch 18/30
28131/28131 - 136s - loss: 0.8359 - val_loss: 0.8466
Epoch 19/30
28131/28131 - 138s - loss: 0.8346 - val_loss: 0.8465
Minimum RMSE at epoch 17 = 0.9195

Model Evaluation

build_model: dot, dense layers: [64, 32, 1]

Display Predicted User Ratings and Actual Ratings

    user_id  movie_id  rating   prediction                                   title                        genres
0      2000      1639       5  [3.6905642]                      Chasing Amy (1997)                 Drama|Romance
1      2000      2529       5  [3.7712362]               Planet of the Apes (1968)                 Action|Sci-Fi
2      2000      1136       5  [4.2867846]  Monty Python and the Holy Grail (1974)                        Comedy
3      2000      2321       5  [3.5867634]                    Pleasantville (1998)                        Comedy
4      2000      2858       5  [4.2984643]                  American Beauty (1999)                  Comedy|Drama
5      2000      2501       5   [4.052319]                      October Sky (1999)                         Drama
6      2000      2804       5   [4.179444]               Christmas Story, A (1983)                  Comedy|Drama
7      2000      1688       5   [3.488712]                        Anastasia (1997)  Animation|Children's|Musical
8      2000      1653       5  [3.6908677]                          Gattaca (1997)         Drama|Sci-Fi|Thriller
9      2000       527       5   [4.332737]                 Schindler's List (1993)                     Drama|War
10     2000      1619       5  [3.3873274]             Seven Years in Tibet (1997)                     Drama|War
11     2000       110       5  [4.2350416]                       Braveheart (1995)              Action|Drama|War
12     2000      1193       5   [4.389355]  One Flew Over the Cuckoo's Nest (1975)                         Drama
13     2000       318       5  [4.5428977]        Shawshank Redemption, The (1994)                         Drama
14     2000      1748       5  [3.7723193]                        Dark City (1998)     Film-Noir|Sci-Fi|Thriller
15     2000      1923       5   [4.060568]     There's Something About Mary (1998)                        Comedy
16     2000      1259       5  [4.1051226]                      Stand by Me (1986)        Adventure|Comedy|Drama
17     2000       595       5  [3.8549566]             Beauty and the Beast (1991)  Animation|Children's|Musical
18     2000      2028       5  [4.2522035]              Saving Private Ryan (1998)              Action|Drama|War
19     2000      1907       5  [3.6439192]                            Mulan (1998)          Animation|Children's

Display Predicted User Ratings for Recommendation

    movie_id   prediction                                       title                genres
0        787   [5.112564]          Gate of Heavenly Peace, The (1995)           Documentary
1       1830  [5.0259943]                     Follow the Bitch (1998)                Comedy
2       3607   [5.020267]                    One Little Indian (1973)  Comedy|Drama|Western
3       3233  [4.9607196]                        Smashing Time (1967)                Comedy
4       3881   [4.960631]                    Bittersweet Motel (2000)           Documentary
5        130  [4.9094844]                               Angela (1995)                 Drama
6       3888   [4.842818]                        Skipped Parts (2000)         Drama|Romance
7       3245    [4.79846]         I Am Cuba (Soy Cuba/Ya Kuba) (1964)                 Drama
8       3656   [4.796293]                                Lured (1947)                 Crime
9       3382    [4.79462]                      Song of Freedom (1936)                 Drama
10       989   [4.756868]   Schlafes Bruder (Brother of Sleep) (1995)                 Drama
11      1795   [4.737964]         Callejón de los milagros, El (1995)                 Drama
12      1871  [4.6523113]            Friend of the Deceased, A (1997)          Comedy|Drama
13       439  [4.6423717]                       Dangerous Game (1993)                 Drama
14       578  [4.6350074]                 Hour of the Pig, The (1993)         Drama|Mystery
15      3172   [4.632602]                     Ulysses (Ulisse) (1954)             Adventure
16      3413  [4.6149454]                               Impact (1949)           Crime|Drama
17        53   [4.610443]                             Lamerica (1994)                 Drama
18      2309  [4.6077538]  Inheritors, The (Die Siebtelbauern) (1998)                 Drama
19       684  [4.5831347]                              Windows (1980)                 Drama
build_model: dot, dense layers: [32, 16, 1]

Model Summary

Model Parameters:
	merge layer: dot
	embedding size: 100
	dense layers: [32, 16, 1]

Save name: dot_100_32_16_1.h5
Model: "functional_61"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_61 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
input_62 (InputLayer)           [(None, 1)]          0                                            
__________________________________________________________________________________________________
embedding_60 (Embedding)        (None, 1, 100)       604000      input_61[0][0]                   
__________________________________________________________________________________________________
embedding_61 (Embedding)        (None, 1, 100)       395200      input_62[0][0]                   
__________________________________________________________________________________________________
dot_6 (Dot)                     (None, 100, 100)     0           embedding_60[0][0]               
                                                                 embedding_61[0][0]               
__________________________________________________________________________________________________
dense_90 (Dense)                (None, 100, 32)      3232        dot_6[0][0]                      
__________________________________________________________________________________________________
dense_91 (Dense)                (None, 100, 16)      528         dense_90[0][0]                   
__________________________________________________________________________________________________
dense_92 (Dense)                (None, 100, 1)       17          dense_91[0][0]                   
==================================================================================================
Total params: 1,002,977
Trainable params: 1,002,977
Non-trainable params: 0
__________________________________________________________________________________________________
None
Epoch 1/30
28131/28131 - 121s - loss: 1.2318 - val_loss: 1.1047
Epoch 2/30
28131/28131 - 122s - loss: 1.0325 - val_loss: 1.0022
Epoch 3/30
28131/28131 - 121s - loss: 0.9642 - val_loss: 0.9540
Epoch 4/30
28131/28131 - 121s - loss: 0.9339 - val_loss: 0.9312
Epoch 5/30
28131/28131 - 123s - loss: 0.9151 - val_loss: 0.9162
Epoch 6/30
28131/28131 - 121s - loss: 0.9012 - val_loss: 0.9033
Epoch 7/30
28131/28131 - 121s - loss: 0.8898 - val_loss: 0.8934
Epoch 8/30
28131/28131 - 121s - loss: 0.8805 - val_loss: 0.8897
Epoch 9/30
28131/28131 - 122s - loss: 0.8721 - val_loss: 0.8802
Epoch 10/30
28131/28131 - 121s - loss: 0.8650 - val_loss: 0.8712
Epoch 11/30
28131/28131 - 121s - loss: 0.8590 - val_loss: 0.8669
Epoch 12/30
28131/28131 - 122s - loss: 0.8538 - val_loss: 0.8622
Epoch 13/30
28131/28131 - 121s - loss: 0.8494 - val_loss: 0.8587
Epoch 14/30
28131/28131 - 122s - loss: 0.8457 - val_loss: 0.8554
Epoch 15/30
28131/28131 - 122s - loss: 0.8426 - val_loss: 0.8529
Epoch 16/30
28131/28131 - 120s - loss: 0.8401 - val_loss: 0.8514
Epoch 17/30
28131/28131 - 120s - loss: 0.8378 - val_loss: 0.8585
Epoch 18/30
28131/28131 - 122s - loss: 0.8359 - val_loss: 0.8458
Epoch 19/30
28131/28131 - 122s - loss: 0.8344 - val_loss: 0.8441
Epoch 20/30
28131/28131 - 121s - loss: 0.8330 - val_loss: 0.8436
Epoch 21/30
28131/28131 - 122s - loss: 0.8319 - val_loss: 0.8419
Epoch 22/30
28131/28131 - 121s - loss: 0.8310 - val_loss: 0.8427
Epoch 23/30
28131/28131 - 123s - loss: 0.8302 - val_loss: 0.8401
Epoch 24/30
28131/28131 - 122s - loss: 0.8296 - val_loss: 0.8387
Epoch 25/30
28131/28131 - 121s - loss: 0.8288 - val_loss: 0.8391
Epoch 26/30
28131/28131 - 124s - loss: 0.8283 - val_loss: 0.8373
Epoch 27/30
28131/28131 - 121s - loss: 0.8277 - val_loss: 0.8445
Epoch 28/30
28131/28131 - 122s - loss: 0.8272 - val_loss: 0.8384
Minimum RMSE at epoch 26 = 0.9150

Model Evaluation

build_model: dot, dense layers: [32, 16, 1]

Display Predicted User Ratings and Actual Ratings

    user_id  movie_id  rating   prediction                                   title                        genres
0      2000      1639       5  [3.7873921]                      Chasing Amy (1997)                 Drama|Romance
1      2000      2529       5  [3.6907656]               Planet of the Apes (1968)                 Action|Sci-Fi
2      2000      1136       5   [4.445865]  Monty Python and the Holy Grail (1974)                        Comedy
3      2000      2321       5  [3.6605468]                    Pleasantville (1998)                        Comedy
4      2000      2858       5  [4.4212494]                  American Beauty (1999)                  Comedy|Drama
5      2000      2501       5   [4.111441]                      October Sky (1999)                         Drama
6      2000      2804       5  [4.3186827]               Christmas Story, A (1983)                  Comedy|Drama
7      2000      1688       5  [3.4750838]                        Anastasia (1997)  Animation|Children's|Musical
8      2000      1653       5  [3.7910407]                          Gattaca (1997)         Drama|Sci-Fi|Thriller
9      2000       527       5   [4.346731]                 Schindler's List (1993)                     Drama|War
10     2000      1619       5   [3.494899]             Seven Years in Tibet (1997)                     Drama|War
11     2000       110       5   [4.179592]                       Braveheart (1995)              Action|Drama|War
12     2000      1193       5   [4.447599]  One Flew Over the Cuckoo's Nest (1975)                         Drama
13     2000       318       5  [4.4633293]        Shawshank Redemption, The (1994)                         Drama
14     2000      1748       5  [3.8833435]                        Dark City (1998)     Film-Noir|Sci-Fi|Thriller
15     2000      1923       5  [3.9120595]     There's Something About Mary (1998)                        Comedy
16     2000      1259       5  [4.1076956]                      Stand by Me (1986)        Adventure|Comedy|Drama
17     2000       595       5   [3.921843]             Beauty and the Beast (1991)  Animation|Children's|Musical
18     2000      2028       5  [4.4091263]              Saving Private Ryan (1998)              Action|Drama|War
19     2000      1907       5  [3.6828299]                            Mulan (1998)          Animation|Children's

Display Predicted User Ratings for Recommendation

    movie_id   prediction                                          title                genres
0        787  [5.2677956]             Gate of Heavenly Peace, The (1995)           Documentary
1        989  [5.1996737]      Schlafes Bruder (Brother of Sleep) (1995)                 Drama
2       2309   [5.151521]     Inheritors, The (Die Siebtelbauern) (1998)                 Drama
3       3172  [5.1305094]                        Ulysses (Ulisse) (1954)             Adventure
4       1830   [5.110937]                        Follow the Bitch (1998)                Comedy
5        130   [5.077912]                                  Angela (1995)                 Drama
6       3656   [5.058428]                                   Lured (1947)                 Crime
7       3233   [5.016838]                           Smashing Time (1967)                Comedy
8       2308   [4.993898]                            Detroit 9000 (1973)          Action|Crime
9       3607   [4.988545]                       One Little Indian (1973)  Comedy|Drama|Western
10      3890  [4.9324465]                              Back Stage (2000)           Documentary
11      3881   [4.926479]                       Bittersweet Motel (2000)           Documentary
12      3382   [4.926086]                         Song of Freedom (1936)                 Drama
13       789  [4.8544064]  I, Worst of All (Yo, la peor de todas) (1990)                 Drama
14      3245   [4.839443]            I Am Cuba (Soy Cuba/Ya Kuba) (1964)                 Drama
15      1871  [4.8214645]               Friend of the Deceased, A (1997)          Comedy|Drama
16      1795  [4.8099213]            Callejón de los milagros, El (1995)                 Drama
17       439   [4.801976]                          Dangerous Game (1993)                 Drama
18      1724  [4.7727356]                              Full Speed (1996)                 Drama
19      3888   [4.752841]                           Skipped Parts (2000)         Drama|Romance
